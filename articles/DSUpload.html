<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DSUpload • dsUpload</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DSUpload">
<meta property="og:description" content="dsUpload">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsUpload</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DSUpload.html">DSUpload</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>DSUpload</h1>
            
      
      
      <div class="hidden name"><code>DSUpload.Rmd</code></div>

    </div>

    
    
<div id="datashield-upload-tools" class="section level1">
<h1 class="hasAnchor">
<a href="#datashield-upload-tools" class="anchor"></a>DataSHIELD upload tools</h1>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The aim of the EU Child Cohort Network is to bring together data from existing pregnancy, child cohorts and biobanks into one open and sustainable, multi-disciplinary network.</p>
<p>To ensure sure that the EU Child Cohort Network is both open and sustainable, the consortia are using the data-sharing platform DataSHIELD.</p>
<p>Participating cohorts must harmonise data following the data harmonisation manuals provided above, perform quality-control checks on their harmonised data and upload descriptions of harmonisation to the cohort catalogue. The last step is uploading the data into the DataSHIELD backends. The guide below guides you through the process.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<blockquote>
<p>For Armadillo reference documentation check: <a href="https://molgenis.github.io/molgenis/molgenis-r-datashield" class="uri">https://molgenis.github.io/molgenis/molgenis-r-datashield</a> For Opal reference documentation check: <a href="http://opaldoc.obiba.org/en/latest/r-user-guide/datashield.html" class="uri">http://opaldoc.obiba.org/en/latest/r-user-guide/datashield.html</a></p>
</blockquote>
<p>You can install the package by executing the following command:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"dsUpload"</span>, <span class="kw">repos</span><span class="kw">=</span><span class="st">'https://registry.molgenis.org/repository/R/'</span>, <span class="kw">dependencies</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; Installing package into '/home/travis/R/Library'</span>
<span class="co">#&gt; (as 'lib' is unspecified)</span>
<span class="co">#&gt; Warning: package 'dsUpload' is not available (for R version 4.0.0)</span></pre></body></html></div>
</div>
<div id="troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting" class="anchor"></a>Troubleshooting</h2>
<p>Check: <a href="https://github.com/lifecycle-project/ds-upload/blob/master/TROUBLESHOOTING.md">troubleshooting guide</a></p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>To simplify the upload and importing of data dictionaries, This package is written to carry, import and upload the data dictionaries and data in one run. When running the package, you need to specify the data dictionary version and the data input file.</p>
<p><strong>Prerequisites</strong></p>
<ul>
<li>To upload the core variables, you need to merge all the variables that are obtained in the dictionary of the core variables. So in general that means merge the data of WP1 and WP3 into one set.</li>
<li>To upload the outcome variables, you need to merge all the variables that are obtained in the dictionary of the outcome variables. So in general this means merge the data of WP4, WP5 and WP6 into one set.</li>
</ul>
<p>A video guiding you through the process can be found here:</p>
<p>Check youtube channel: <a href="https://youtu.be/fUrpbstPCsU">upload data dictionaries and data into opal</a></p>
<p>Alternatively, execute these commands in your R-console:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># load the package</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dsUpload</span>)
<span class="co">#&gt; Loading required package: opalr</span>
<span class="co">#&gt; Loading required package: httr</span>

<span class="co"># login to the DataSHIELD backend</span>
<span class="fu"><a href="../reference/du.login.html">du.login</a></span>(
  <span class="kw">hostname</span> <span class="kw">=</span> <span class="st">'https://cohort1-opal.test.molgenis.org'</span>,
  <span class="kw">username</span> <span class="kw">=</span> <span class="st">'administrator'</span>,
  <span class="kw">password</span> <span class="kw">=</span> <span class="st">'?LifeCycleCohort1!'</span>)
<span class="co">#&gt;   Login to: "https://cohort1-opal.test.molgenis.org"</span>
<span class="co">#&gt;   Logged on to: "https://cohort1-opal.test.molgenis.org"</span>

<span class="co"># upload the data into the DataSHIELD backend</span>
<span class="co"># these are the core variables</span>
<span class="co"># be advised the default input format is 'CSV'</span>
<span class="co"># you can use STATA, SPSS, SAS and CSV's as source files</span>
<span class="fu"><a href="../reference/du.upload.html">du.upload</a></span>(
  <span class="kw">cohort_id</span> <span class="kw">=</span> <span class="st">'dnbc'</span>,
  <span class="kw">dict_version</span> <span class="kw">=</span> <span class="st">'2_1'</span>,
  <span class="kw">dict_kind</span> <span class="kw">=</span> <span class="st">'core'</span>,
  <span class="kw">data_version</span> <span class="kw">=</span> <span class="st">'1_0'</span>,
  <span class="kw">data_input_format</span> <span class="kw">=</span> <span class="st">'CSV'</span>,
  <span class="kw">data_input_path</span> <span class="kw">=</span> <span class="st">'https://github.com/lifecycle-project/analysis-protocols/blob/master/R/test/WP1/data/all_measurements_v1_2.csv?raw=true'</span>,
  <span class="kw">non_interactive</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start upload data into DataSHIELD backend</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start download dictionaries</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt; * Download: [ 2_1_monthly_rep.xlsx ]</span>
<span class="co">#&gt; * Download: [ 2_1_non_rep.xlsx ]</span>
<span class="co">#&gt; * Download: [ 2_1_trimester_rep.xlsx ]</span>
<span class="co">#&gt; * Download: [ 2_1_yearly_rep.xlsx ]</span>
<span class="co">#&gt;   Successfully downloaded dictionaries</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start importing data dictionaries</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt;   Start creating project: [ lc_dnbc_core_2_1 ]</span>
<span class="co">#&gt; * Project: [ lc_dnbc_core_2_1 ] already exists</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt;   Start importing dictionaries</span>
<span class="co">#&gt; * Table: [ 2_1_core_1_0_monthly_rep ] already exists</span>
<span class="co">#&gt; * Import variables into: [ 2_1_core_1_0_monthly_rep ]</span>
<span class="co">#&gt; * Table: [ 2_1_core_1_0_non_rep ] already exists</span>
<span class="co">#&gt; * Matched categories for table: [ 2_1_core_1_0_non_rep ]</span>
<span class="co">#&gt; * Import variables into: [ 2_1_core_1_0_non_rep ]</span>
<span class="co">#&gt; * Table: [ 2_1_core_1_0_trimester_rep ] already exists</span>
<span class="co">#&gt; * Matched categories for table: [ 2_1_core_1_0_trimester_rep ]</span>
<span class="co">#&gt; * Import variables into: [ 2_1_core_1_0_trimester_rep ]</span>
<span class="co">#&gt; * Table: [ 2_1_core_1_0_yearly_rep ] already exists</span>
<span class="co">#&gt; * Matched categories for table: [ 2_1_core_1_0_yearly_rep ]</span>
<span class="co">#&gt; * Import variables into: [ 2_1_core_1_0_yearly_rep ]</span>
<span class="co">#&gt;   All dictionaries are populated correctly</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Importing data dictionaries has finished</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start reshaping data</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt; * Setup: load data and set output directory</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt; [WARNING] This is an unmatched column, it will be dropped : [ art ].</span>
<span class="co">#&gt; * Generating: non-repeated measures</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/AUXIANRELJNDLFQ/2020-07-12_21-12-27_core_1_0_non_repeated_measures.csv</span>
<span class="co">#&gt; * Generating: yearly-repeated measures</span>
<span class="co">#&gt; Aggregate function missing, defaulting to 'length'</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/AUXIANRELJNDLFQ/2020-07-12_21-12-27_core_1_0_yearly_repeated_measures.csv</span>
<span class="co">#&gt; * Generating: monthly-repeated measures</span>
<span class="co">#&gt; Aggregate function missing, defaulting to 'length'</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/AUXIANRELJNDLFQ/2020-07-12_21-12-27_core_1_0_monthly_repeated_measures.csv</span>
<span class="co">#&gt; * Generating: trimesterly-repeated measures</span>
<span class="co">#&gt; Aggregate function missing, defaulting to 'length'</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/AUXIANRELJNDLFQ/2020-07-12_21-12-27_core_1_0_trimester_repeated_measures.csv</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Reshaping successfully finished</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;  * Reinstate default working directory</span>
<span class="co">#&gt;  * Cleanup temporary directory</span>

<span class="co"># upload the outcome variables</span>
<span class="fu"><a href="../reference/du.upload.html">du.upload</a></span>(
  <span class="kw">cohort_id</span> <span class="kw">=</span> <span class="st">'dnbc'</span>,
  <span class="kw">dict_version</span> <span class="kw">=</span> <span class="st">'1_1'</span>,
  <span class="kw">dict_kind</span> <span class="kw">=</span> <span class="st">'outcome'</span>,
  <span class="kw">data_version</span> <span class="kw">=</span> <span class="st">'1_0'</span>,
  <span class="kw">data_input_format</span> <span class="kw">=</span> <span class="st">'CSV'</span>,
  <span class="kw">data_input_path</span> <span class="kw">=</span> <span class="st">'https://github.com/lifecycle-project/analysis-protocols/blob/master/R/test/WP6/nd_data_wp6.csv?raw=true'</span>,
  <span class="kw">non_interactive</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start upload data into DataSHIELD backend</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start download dictionaries</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt; * Download: [ 1_1_monthly_rep.xlsx ]</span>
<span class="co">#&gt; * Download: [ 1_1_non_rep.xlsx ]</span>
<span class="co">#&gt; * Download: [ 1_1_weekly_rep.xlsx ]</span>
<span class="co">#&gt; * Download: [ 1_1_yearly_rep.xlsx ]</span>
<span class="co">#&gt;   Successfully downloaded dictionaries</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start importing data dictionaries</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt;   Start creating project: [ lc_dnbc_outcome_1_1 ]</span>
<span class="co">#&gt; * Project: [ lc_dnbc_outcome_1_1 ] already exists</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt;   Start importing dictionaries</span>
<span class="co">#&gt; * Table: [ 1_1_outcome_1_0_monthly_rep ] already exists</span>
<span class="co">#&gt; * Matched categories for table: [ 1_1_outcome_1_0_monthly_rep ]</span>
<span class="co">#&gt; * Import variables into: [ 1_1_outcome_1_0_monthly_rep ]</span>
<span class="co">#&gt; * Table: [ 1_1_outcome_1_0_non_rep ] already exists</span>
<span class="co">#&gt; * Matched categories for table: [ 1_1_outcome_1_0_non_rep ]</span>
<span class="co">#&gt; * Import variables into: [ 1_1_outcome_1_0_non_rep ]</span>
<span class="co">#&gt; * Table: [ 1_1_outcome_1_0_weekly_rep ] already exists</span>
<span class="co">#&gt; * Import variables into: [ 1_1_outcome_1_0_weekly_rep ]</span>
<span class="co">#&gt; * Table: [ 1_1_outcome_1_0_yearly_rep ] already exists</span>
<span class="co">#&gt; * Matched categories for table: [ 1_1_outcome_1_0_yearly_rep ]</span>
<span class="co">#&gt; * Import variables into: [ 1_1_outcome_1_0_yearly_rep ]</span>
<span class="co">#&gt;   All dictionaries are populated correctly</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Importing data dictionaries has finished</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Start reshaping data</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt; * Setup: load data and set output directory</span>
<span class="co">#&gt; ------------------------------------------------------</span>
<span class="co">#&gt; * Generating: non-repeated measures</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/NTQQXPUTXSRNZAC/2020-07-12_21-12-45_outcome_1_0_non_repeated_measures.csv</span>
<span class="co">#&gt; * Generating: yearly-repeated measures</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/NTQQXPUTXSRNZAC/2020-07-12_21-12-45_outcome_1_0_yearly_repeated_measures.csv</span>
<span class="co">#&gt; * Generating: monthly-repeated measures</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/NTQQXPUTXSRNZAC/2020-07-12_21-12-45_outcome_1_0_monthly_repeated_measures.csv</span>
<span class="co">#&gt; * Generating: weekly-repeated measures</span>
<span class="co">#&gt; * Upload: /home/travis/build/sidohaakma/analysis-protocols/vignettes/NTQQXPUTXSRNZAC/2020-07-12_21-12-45_outcome_1_0_weekly_repeated_measures.csv</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;   Reshaping successfully finished</span>
<span class="co">#&gt; ######################################################</span>
<span class="co">#&gt;  * Reinstate default working directory</span>
<span class="co">#&gt;  * Cleanup temporary directory</span></pre></body></html></div>
<blockquote>
<p><strong>IMPORTANT</strong>: Check if the data is correctly imported in the tables in Opal. Randomly select some values and check if they are correct with your actual data. That should be sufficient to know if the data is imported correctly,</p>
</blockquote>
<blockquote>
<p><strong>IMPORTANT</strong>: You can run this package for the core variables and for the outcome variables. Each of them requires changing some parameters in the function call. So dict_kind specific ‘core’ or ‘outcome’ variables and dict_version specifies the data dictionary version (check the changelogs here: <a href="https://github.com/lifecycle-project/analysis-protocols/tree/master/changelogs" class="uri">https://github.com/lifecycle-project/analysis-protocols/tree/master/changelogs</a>).</p>
</blockquote>
<blockquote>
<p><strong>IMPORTANT</strong> You can specify your upload format! So you do not have to export to CSV first. Supported upload formats are: ‘SPSS’, ‘SAS’, ‘STATA’ and ‘CSV’.</p>
</blockquote>
<p>Having run these commands, your data will now be uploaded to Opal. You can now import these data into the tables manually in Opal.</p>
<p>A video guiding you through the process can be found here:</p>
<p>Check youtube channel: <a href="https://youtu.be/BKDnIAQzpdY">import data into Opal</a></p>
<p>Alternatively, execute these actions:</p>
<ol style="list-style-type: decimal">
<li>Navigate to the Opal web interface</li>
<li>Login with you credentials</li>
<li>Select “Projects”</li>
<li>Select "lifecycle_#cohort#_#dict_kind#_x_x"</li>
<li>Select “Import”</li>
<li>Choose the CSV-file</li>
<li>Select the target table (depending on your choice regarding the file you have chosen)</li>
<li>Click on “Next”</li>
<li>Click on “Next”</li>
<li>Determine that you all variables are matched, otherwise you need to fix your source-data first <strong>IMPORTANT</strong>: make sure no NEW variables are introduce</li>
<li>Click on “Finish”</li>
<li>Check the “Task logs” (on the left side of the screen, in the icon bar)</li>
</ol>
<p>It will match your data dictionary and determine which variables are matched or not. You can re-upload the source files as often as needed.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sido Haakma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
