#' Quality control of core harmonized variables in LifeCycle
#'
#'
#' @details
#' Procedures for quality checks of harmonised core variables
#' \enumerate{
#'   \item Verify the list of variables and formats
#'   \item Check the univariate distributions
#'   \item Check internal validity
#'   \item Check consistency in repeated measures
#' }
#'
#' You can run all of the categories or seperate ones
#' \itemize{
#'   \item All catagories (ALL)
#'   \item Meta variables (META)
#'   \item Maternal characteristics (MATERNAL)
#'   \item Paternal characteristics (PATERNAL)
#'   \item Child characteristics (CHILD)
#'   \item Househild characteristics (HOUSEHOLD)
#' }
#'
#' @section Warning:
#' Some of the functions here will throw "Error's". This is most likely
#' due to the fact that the variable that you are cross checking has no values and only missing
#' If that is the case, just make sure the variable exists in your data set and move on to the
#' next.
#'
#' @param input_format possible formats are CSV,STATA,SPSS or SAS (default = CSV)
#' @param input_path path for importfile
#' @param variable_category describes the categories you want to run in your quality control (possible values are: ALL, META, MATERNAL, PATERNAL, CHILD and HOUSEHOLD - default = ALL)
#'
lc.quality.local.core <-
  local(function(input_format = 'CSV',
                 input_path,
                 variable_category = 'ALL') {
    message('######################################################')
    message('  Starting local quality control                      ')
    message('######################################################')
    
    lc_data <- lc.read.source.file(input_path, input_format)
    
    if (variable_category == 'ALL' ||
        variable_category == 'META')
      lc.quality.local.core.meta(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'MATERNAL')
      lc.quality.local.core.maternal.social.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'MATERNAL')
      lc.quality.local.core.maternal.health.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'MATERNAL')
      lc.quality.local.core.maternal.lifestyle.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'MATERNAL')
      lc.quality.local.core.maternal.obstetric.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'PATERNAL')
      lc.quality.local.core.paternal.health.related.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'PATERNAL')
      lc.quality.local.core.paternal.lifestyle.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'PATERNAL')
      lc.quality.local.core.paternal.socio.demo.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'CHILD')
      lc.quality.local.core.child.birth.out(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'CHILD')
      lc.quality.local.core.child.exposure.lifestyle.environ.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'CHILD')
      lc.quality.local.core.child.exposure.lifestyle.environ.char(lc_data)
    if (variable_category == 'ALL' ||
        variable_category == 'HOUSEHOLD')
      lc.quality.local.core.household.char(lc_data)
    
  })

#' Run checks on metadata variables in LifeCycle
#' It involves variables 1-7
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#' @importFrom ggplot2 theme_set theme_minimal geom_bar
#' @importFrom dplyr count arrange group_by row_number
#'
lc.quality.local.core.meta <- local(function(lc_data) {
  message("- Meta - variables")
  # workaround to avoid glpobal variable warnings, check: https://stackoverflow.com/questions/9439256/how-can-i-handle-r-cmd-check-no-visible-binding-for-global-variable-notes-when
  lifecyclelc_data <-
    birth_month <-
    birth_year <- mother_id <- dob <- preg_no <- child_id <- . <- NULL
  
  theme_set(theme_minimal())
  
  # 1. MOTHER IDENTIFIER ('mother_id')
  # * Check that you have used either the original ID or a new ID generated by the cohort (the ID's corresponds to mothers in the cohort)
  list(
    data_type = class(lifecyclelc_data$mother_id),
    category_numbers = table(lc_data$mother_id),
    summary_stats = summarizeR(lc_data, "mother_id")
  )
  
  # * Please, check this number against any previously reported distribution of number of [mothers] in your cohort
  
  #------------------------------------------------------------------------------------------------#
  # 2. PREGNANCY NUMBER ('preg_no')
  # * Pregnancy number increases with each subsequent pregnancy included in the cohort (i.e. '1' is allocated to the first pregnancy included,
  # '2' is allocated to the second pregnancy included, etc.).
  
  # * Check pregnancy order (if pregnancies > 1) against date of birth of the children, for example by this syntax:
  TEST <- lc_data %>%
    mutate(dob = paste(birth_month, birth_year)) %>% # creates the data of birth based on month and year
    arrange(mother_id, dob) %>%
    select(mother_id, dob, preg_no, child_id) %>%
    group_by(mother_id) %>%
    mutate(preg_no_check = row_number())
  
  # Check if the number is the same based on date of birth and actual coding
  CrossTable(TEST$preg_no, TEST$preg_no_check)
  
  
  # This shows the subset of the data set where the check variable is not the same as the actual variable
  subset(TEST, TEST$preg_no != TEST$preg_no_check)
  
  # * Check for outliers and impossible values (e.g. a substantial high amount of pregnancies within the time of follow-up)
  ggplotly(TEST %>%
             ggplot(aes(factor(x = preg_no))) +
             geom_bar(fill = "#0073C2FF"))
  
  list(
    data_type = class(lc_data$preg_no),
    category_numbers = table(lc_data$preg_no),
    summary_stats = summarizeR(lc_data, "preg_no")
  )
  # * Please, check this number against any previously reported distribution of [within-mother pregnancies] in your cohort
  
  #------------------------------------------------------------------------------------------------#
  
  # 3. CHILD NUMBER ('child_no')
  # * NB! Please, be aware that the definition for this variable has been amended! See Core Variable List for update!
  
  # * Check for correct source variables used and for correct coding
  # * NB! This variable is the within-pregnancy child number
  list(
    data_type = class(lc_data$child_no),
    category_numbers = table(lc_data$child_no),
    summary_stats = summarizeR(lc_data, "child_no")
  )
  
  # * Please, check this number against any previously reported distribution of [number of within-pregnancies (singles, twins and triplets etc.)] in your cohort
  
  # * Check internal validity, e.g:
  CrossTable(lc_data$child_no, lc_data$outcome) # Amend, if mothers have child_no<1 (null children) and outcome=1 (live born) or outcome=2 (still born)
  
  #------------------------------------------------------------------------------------------------#
  
  # 4. CHILD IDENTIFIER ('child_id')
  # * NB! Check that you have used either the original ID or a new ID generated by the cohort (the ID's corresponds to mothers in the cohort)
  lc_data %>%
    arrange(child_id) %>%
    select(child_id) %>%
    group_by(child_id) %>%
    mutate(n = row_number()) %>%
    count(., "n")                   # n should = 1 for all children (i.e. as it is unique)
  
  # * Check for correct number of ID's in the cohort (the ID corresponds to mothers in the cohort)
  list(
    data_type = class(lc_data$child_id),
    category_numbers = table(lc_data$child_id),
    summary_stats = summarizeR(lc_data, "child_id")
  )
  
  #------------------------------------------------------------------------------------------------#
  # 5. COHORT ID ('cohort_id')
  # * Check for correct code
  table(lc_data$cohort_id)
  
  # 101=GenR, 102=INMA, 103=NINFEA, 104=SWS, 105=ASLPAC, 106=DNBC, 107=BIB, 108=GECKO, 109=RHEA,
  # 110=MOBA, 111=ELFE, 112=EDEN, 113=NFBC66, 114=NFBC86, 115=HBCS, 116=CHOP, 117=RAINE
  
  #------------------------------------------------------------------------------------------------#
  # 6. RECRUITMENT AGE ('recruit_age')
  # * Check for correct values in days (i.e. negative values if recruited AFTER birth, positive values if recruited BEFORE birth)
  table(lc_data$recruit_age)
  
  list(
    data_type = class(lc_data$recruit_age),
    category_numbers = table(lc_data$recruit_age),
    summary_stats = summarizeR(lc_data, "recruit_age")
  )
  
  #------------------------------------------------------------------------------------------------#
  # 7. COUNTRY OF COHORT ('coh_country')
  # * Check for correct code (based on ISO3166 numeric country codes)
  table(lc_data$coh_country)
  
  # 36=Australia, 208=Denmark, 246=Finland, 250=France, 276=Germany, 300=Greece
  # 380=Italy, 528=Netherlands, 578=Norway, 724=Spain, 826=United Kingdom
})

#' Part of maternal characteristics
#' Social charasteristics
#' Involves variables 8-17
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#' @importFrom ggplot2 geom_point
#' @importFrom dplyr select_if mutate group_by arrange lag contains
#' @importFrom tidyr spread
#'
lc.quality.local.core.maternal.social.char <-
  local(function(lc_data) {
    message("- Maternal - social demographic characteristics")
    # workaround to avoid glpobal variable warnings, check: https://stackoverflow.com/questions/9439256/how-can-i-handle-r-cmd-check-no-visible-binding-for-global-variable-notes-when
    child_id <-
      coh_country <-
      edu_m_0 <-
      edu_m_17 <-
      orig_var <-
      edu_m_ <-
      variable_trunc <-
      age_years <-
      prev <- edu_diff <- agebirth_m_d <- agebirth_m_y <- . <- .. <- NULL
    
    #  8. COHABITATION STATUS ('cohab_0-17')
    # * NB! Mother's partner can be the biological partner, a new partner or a parther of the same gender
    
    # * Check for correct type [binary], number [two] and definition of categories [1=Yes, living as a couple, 2=No, not living as a couple]
    
    # * Please, check for correct number of time bands [eightteen, 0-17]
    # First: show the range
    lc_data %>%
      select(contains("cohab_")) %>%
      names() %>%
      numextract() %>%
      range()             # This should be 0-17
    
    # Second: print the summary stats for all variables
    var_names <- lc_data %>%
      select(contains("cohab_")) %>%
      names()
    
    for (i in var_names) {
      print(summarizeR(lc_data, i))
    }
    
    # * If more than one measure declared within the period, use the measure closest to the child's first birthday, e.g. for cohab_0 use the
    # measure closest to child's birth and for cohab_1 use the measure closest to child's first birthday)
    
    # * Check that date of collection corresponds to the exact age-band (for all time bands with cohort-specific data) // Se ILLUSTRATED example:
    CrossTable(lc_data$cohab_0, lc_data$weight_age0)
    
    CrossTable(lc_data$cohab_0, "<age_m6>") # where <age_6m> is the cohort-specific variable for age of the child at a FU occurring around the first year of life;
    # age range at this FU =   3 - 28 months
    
    CrossTable(lc_data$cohab_1, lc_data$height_age1)
    ..
    CrossTable(lc_data$cohab_17,  "<age_18>")
    
    #    							INCORRECT														     CORRECT
    #
    #           |                 age_6m										 	   |                 age_6m
    #   cohab_0 |         0          1         2  |     Total			   cohab_0 |         0          1         2  |     Total
    #-----------+---------------------------------+----------			-----------+---------------------------------+----------
    #         1 |    68,533        *63*       *1* |    68,597 			 		 1 |    68,533         *0*       *0* |    68,533
    #         2 |     1,677         *2*       *0* |     1,679 			 		 2 |     1,677         *0*       *0* |     1,677
    #-----------+---------------------------------+----------			-----------+---------------------------------+----------
    #     Total |    70,210        *65*       *1* |    70,276 				 Total |    70,210         *0*       *0* |    70,210
    
    # Amend, if subjects coded in cohab_0 is not age<1 (age_6m=1 or =2) [shown with *]
    
    
    #------------------------------------------------------------------------------------------------#
    
    # 9. MATERNAL OCCUPATIONAL STATUS [CORE] ('occup_m_0-17')
    # * NB! Employed/self-employed incl. maternity leave if employed before commencing maternity leave
    # * NB! If a cohort has no data specifying employed or self-employed, categorise this as employed (AND partial harmonization)
    # * If variable is partially harmonised, please check you have documented this accordingly in the Online Catalogue under 'match'
    
    # * Check for correct type [categorical], number [six] and definition of categories [Occupation status; 1=Empl, 2=Self-empl, 3=Unempl, 4=Stud, 5=Domest, 6=Inactive]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    lc_data %>%
      select(contains("occup_m_")) %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data %>%
      select(contains("occup_m_")) %>%
      names()
    
    for (i in var_names) {
      print(summarizeR(lc_data, i))
    }
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal occupational status] in your cohort
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * Also, if more than one measure declared within the period, use the highest measure (according to the following order: 1 - 6)
    
    #------------------------------------------------------------------------------------------------#
    
    #  10. MATERNAL OCCUPATIONAL CODE [CORE] ('occupcode_m_0-17')
    # * If variable is partially harmonised, please check you have documented this accordingly in the online catalogue under 'match'
    # * Check for correct type [categorical], number [ten] and definition of categories [occupational Codes; 0-9]
    # * Check for correct number of time bands [eightteen, 0-17]
    lc_data %>%
      select(contains("occupcode_m_")) %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data %>%
      select(contains("occupcode_m_")) %>%
      names()
    
    for (i in var_names) {
      print(summarizeR(lc_data, i))
    }
    
    #1) Legislators, senior officials, managers
    #2) Professionals
    #3) Technicians and associate professionals
    #4) Clerks
    #5) Service workers, and shop and market sales workers
    #6) Skilled agricultural, and fishery workers
    #7) Craft and related trades workers
    #8) Plant and machine operators, and assemblers
    #9) Elementary occupations
    #0) Armed forces occupations
    
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal occupational codes] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$edu_m_0, lc_data$occupcode_m_0)
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * Also, if more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 3, 4, 5, 6, 7, 8, 9, 0)
    
    #------------------------------------------------------------------------------------------------#
    
    # 11. MATERNAL EDUCATION [CORE] ('edu_m_0-17')
    # * If variable is partially harmonised, please check you have documented this accordingly in the online catalogue under 'match'
    
    # * Check for correct type [categorical], number [three] and definition of categories [education; 1=High, 2=Medium, 3=Low]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    lc_data %>%
      select(contains("edu_m_")) %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data %>%
      select(contains("edu_m_")) %>%
      names()
    
    for (i in var_names) {
      print(summarizeR(lc_data, i))
    }
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal education] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$agebirth_m_y, lc_data$edu_m_0)
    CrossTable(lc_data$edu_m_0, lc_data$occupcode_m_0) #, row
    
    # * NB! For this variable, it is important to check whether ID change category when not reasonable (i.e. a descrease in level of education over time, e.g. edu_m_0=1 and edu_m10=3)
    
    lc_data %>%
      #select education variables and cohort specific variables
      select(child_id:coh_country, edu_m_0:edu_m_17) %>%
      # drop all columns with all missing values
      select_if(function(x) {
        !all(is.na(x))
      }) %>%
      #reshape to long format
      gather(orig_var, edu_m_, grep("edu_m_", names(.)), na.rm = FALSE) %>%
      # generate a year variable
      mutate(age_years = as.numeric(numextract(orig_var))) %>%
      #take out the year indicator from the education variable
      mutate(variable_trunc = gsub('[[:digit:]]+$', '', orig_var)) %>% #take out the year indicator from the education variable
      spread(key = variable_trunc, value = edu_m_) %>%
      #group the data by child ID so the differences in education level are only calculated within one ID, and not across all IDs
      group_by(child_id) %>%
      arrange(child_id, age_years) %>%
      # this creates a variable with values indicating the previous value of edu_m_
      mutate(prev = lag(edu_m_, order_by = child_id)) %>%
      # create a variable that indicates the difference between the previous value and teh value one year later.
      # If this value is negative, that means the education level decreased over time, which is not plausible
      mutate(edu_diff = edu_m_ - prev) %>%
      # here we take the subset of the data, that has implausible values. Check the ID's and edu_m_X variables for errors
      subset(., edu_diff <  0)
    
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * Also, if more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 3)
    
    #------------------------------------------------------------------------------------------------#
    
    # 12. MATERNAL COUNTRY OF BIRTH ('cob_m')
    # * Check for correct type [categorical], number [three] and definition of categories [0=Born in country of cohort, 1=Born in EU country outside cohort country,
    #  2=Born in other country]
    list(
      data_type = class(lc_data$cob_m),
      category_numbers = table(lc_data$cob_m),
      summary_stats = summarizeR(lc_data, "cob_m")
    )
    
    #* If reasonable, please check the distribution against any previously reported distribution of [maternal country of birth] in your cohort
    
    #------------------------------------------------------------------------------------------------
    #  13. ETHNICITY
    #  a. ('ethn1_m')
    #  * Western countries incl.: EU, Andorra, Australia, New Zealand, Canadata, Iceland, Licechenstein, Monaco, Norway, San Marino, Switzerland, USA, Vatican City.
    #  * Non-Western countries incl.: All other countries
    
    #  * Check for correct type [categorical], number [three] and definition of categories  [Ethnicity; 1=Western, 2=Non-western, 3=Mixed]
    list(
      data_type = class(lc_data$ethn1_m),
      category_numbers = table(lc_data$ethn1_m),
      summary_stats = summarizeR(lc_data, "ethn1_m")
    )
    
    #  * If reasonable, please check the distribution against any previously reported distribution of [maternal ethnicity] in your cohort
    
    #--------------------------------#
    
    # b. ('ethn2_m')
    # * Check for correct type [categorical], number [three] and definition of categories [1=Western(Caucasian), 2=Non-western(non-Caucasion), 3=Mixed]
    list(
      data_type = class(lc_data$ethn2_m),
      category_numbers = table(lc_data$ethn2_m),
      summary_stats = summarizeR(lc_data, "ethn2_m")
    )
    
    #--------------------------------#
    # c. ('ethn3_m')
    # * Check for correct type [categorical], number [three] and definition of categories [1=Western, 2=Non-western, 3=Mixed]
    list(
      data_type = class(lc_data$ethn3_m),
      category_numbers = table(lc_data$ethn3_m),
      summary_stats = summarizeR(lc_data, "ethn3_m")
    )
    
    #------------------------------------------------------------------------------------------------#
    
    # 14. MATERNAL AGE AT BIRTH [YEARS] ('agebirth_m_y')
    # * Check for outliers and impossible values (i.e. typically outside age rage of 15-50 years)
    list(
      data_type = class(lc_data$agebirth_m_y),
      category_numbers = table(lc_data$agebirth_m_y),
      summary_stats = summarizeR(lc_data, "agebirth_m_y")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal age at birth, in years] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$agebirth_m_y, lc_data$parity_m)
    
    #------------------------------------------------------------------------------------------------#
    
    # 15. MATERNAL AGE AT BIRTH [DAYS] ('agebirth_m_d')
    # * Check internal validity with reasonable cross-tabulations, e.g.:
    # in this plot, all values should be on a straight line, as this indicates month corresponds to year
    ggplotly(lc_data %>%
               ggplot(aes(agebirth_m_d, agebirth_m_y)) +
               geom_point())
    
    #------------------------------------------------------------------------------------------------#
    
    # 16. MATERNAL DEATH ('death_m')
    # * Check for correct type [binary], number [two] and definition of categories [0=No death of child's mother, 1=Yes, death of child's mother]
    list(
      data_type = class(lc_data$death_m),
      category_numbers = table(lc_data$death_m),
      summary_stats = summarizeR(lc_data, "death_m")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$death_m, lc_data$death_m_age)
    
    #------------------------------------------------------------------------------------------------#
    
    # 17. AGE OF CHILD AT DEATH OF THE MOTHER ('death_m_age')
    # * Check for outliers and impossible values
    list(
      data_type = class(lc_data$death_m_age),
      category_numbers = table(lc_data$death_m_age),
      summary_stats = summarizeR(lc_data, "death_m_age")
    )
    
  })

#' Part of maternal characteristics
#' Health related characteristics
#' This involes variables 18-31
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#' @importFrom ggplot2 geom_point theme_minimal
#'
lc.quality.local.core.maternal.health.char <-
  local(function(lc_data) {
    message("- Maternal - health related characteristics")
    # workaround to avoid glpobal variable warnings, check: https://stackoverflow.com/questions/9439256/how-can-i-handle-r-cmd-check-no-visible-binding-for-global-variable-notes-when
    agebirth_m_y <-
      height_m <-
      latepreg_weight <- preg_gain <- gain2 <- prepreg_weight <- NULL
    
    # 18. PRE-PREGNANCY WEIGHT
    # a. ('prepreg_weight')
    # * NB! If pre-pregnancy weight is not available, use early pregnancy weight closest to conception, limited to 1st trimester (<12 weeks).
    # * NB! If early pregnancy weight is used the variable is partially harmonised; partial harmonisation should be detailed in the Online Catalogue under "match"
    # * NB! If an early pregnancy weight is used in place of pre-pregnancy weight, gestational age at time of measurement should be provided in variable "prepreg_weight_ga".
    
    # * Check for outliers and impossible values (e.g. substantial low or high weight in kg)
    summarizeR(lc_data, "prepreg_weight")
    list(
      data_type = class(lc_data$prepreg_weight),
      summary_stats = summarizeR(lc_data, "prepreg_weight")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$prepreg_weight, lc_data$agebirth_m_y)
    # or in plot:
    ggplotly(lc_data %>%
               ggplot(aes(prepreg_weight, agebirth_m_y)) +
               geom_point())
    CrossTable(lc_data$prepreg_weight, lc_data$height_m)
    # or in plot:
    ggplotly(lc_data %>%
               ggplot(aes(prepreg_weight, height_m)) +
               geom_point())
    CrossTable(lc_data$prepreg_weight, lc_data$latepreg_weight)
    # or in plot:
    ggplotly(lc_data %>%
               ggplot(aes(prepreg_weight, latepreg_weight)) +
               geom_point())
    
    #--------------------------------#
    #  b. ('prepreg_weight_mes')
    # * Check for correct type [binary], number [two] and definition of categories [reported vs. measured weight; 0=Self-measured, 1=Measured]
    list(
      data_type = class(lc_data$prepreg_weight_mes),
      category_numbers = table(lc_data$prepreg_weight_mes),
      summary_stats = summarizeR(lc_data, "prepreg_weight_mes")
    )
    #--------------------------------#
    #  c. ('prepreg_weight_ga')
    # * Missing if prepreg_weight is pre-pregnancy weight as opposed to early pregnancy weight
    
    # * Check for outliers and impossible values (e.g. substantial low or high gestational age)
    list(
      data_type = class(lc_data$prepreg_weight_ga),
      summary_stats = summarizeR(lc_data, "prepreg_weight_ga")
    )
    #------------------------------------------------------------------------------------------------#
    
    # 19. LATE PREGNANCY WEIGHT
    # a. ('latepreg_weight')
    # * NB! If a pregnancy weight within one week of delivery is not available, a late pregnancy weight closest to delivery from 32 weeks gestation is acceptable.
    # * This will be partial harmonisation, which should be indicated and detailed in the online catalogue under 'match'
    
    # * Check for outliers and impossible values (e.g. substantial low or high weight in kg)
    summarizeR(lc_data, "latepreg_weight")
    list(
      data_type = class(lc_data$latepreg_weight),
      summary_stats = summarizeR(lc_data, "latepreg_weight")
    )
    
    # * Check internal validity, e.g.:
    ggplotly(ggplot(lc_data, aes(latepreg_weight, preg_gain)) +
               geom_point() +
               theme_minimal())
    
    #--------------------------------#
    #  b. ('latepreg_weight_mes')
    # * Check for correct type [binary], number [two] and definition of categories [reported vs. measured weight; 0=Self-measured, 1=Measured]
    list(
      data_type = class(lc_data$latepreg_weight_mes),
      category_numbers = table(lc_data$latepreg_weight_mes),
      summary_stats = summarizeR(lc_data, "latepreg_weight_mes")
    )
    
    #--------------------------------#
    #  c. ('latepreg_weight_ga')
    # * Check for outliers and impossible values (e.g. substantial low or high gestational age)
    list(
      data_type = class(lc_data$prepreg_weight_mes),
      summary_stats = summarizeR(lc_data, "prepreg_weight_mes")
    )
    
    #------------------------------------------------------------------------------------------------#
    
    # 20. MATERNAL GESTATIONAL WEIGHT GAIN
    # a. ('preg_gain')
    # * NB! Where gestational weight gain is calculated: take the measures perceived to be the best measurements and report in the Online Catalogue exactly what measures have been used to derive the variable.
    # * Also, the variable is fully harmonised if data cover the whole pregnancy - document this complete/partial harmonization accordingly in the online catalogue under 'match'
    
    # * Check for outliers and impossible values (e.g. substantial low or high weight, in kg)
    # ** NB! Negative variables for weight loss and positive variables for weight gain
    list(
      data_type = class(lc_data$preg_gain),
      summary_stats = summarizeR(lc_data, "preg_gain")
    )
    # and plot
    ggplotly(ggplot(lc_data, aes(y = preg_gain)) + geom_boxplot())
    
    # * Check internal validity, e.g:
    ggplotly(ggplot(lc_data, aes(latepreg_weight, prepreg_weight)) +
               geom_point())
    
    
    ggplotly(
      lc_data %>%
        mutate(gain2 = latepreg_weight - prepreg_weight) %>%
        ggplot(aes(gain2, preg_gain)) +
        geom_point()
    )
    
    
    #--------------------------------#
    
    # b. ('preg_gain_mes')
    # * Check for correct type [categorical], number [three] and definition of categories [0=Self-measured, 1=Measured, 2=Pre-preg measured and late-preg reported, 3=Pre-preg reported and late-preg reported]
    list(
      data_type = class(lc_data$preg_gain_mes),
      category_numbers = table(lc_data$preg_gain_mes),
      summary_stats = summarizeR(lc_data, "preg_gain_mes")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$preg_gain_mes, lc_data$prepreg_weight_mes)
    CrossTable(lc_data$preg_gain_mes, lc_data$latepreg_weight_mes)
    
    #------------------------------------------------------------------------------------------------#
    
    # 21. MATERNAL HEIGHT
    # a. ('height_m')
    # * NB! Use measured height if available!
    
    #  * Check for outliers and impossible values (e.g. substantial low or high height, in cm)
    list(
      data_type = class(lc_data$height_m),
      summary_stats = summarizeR(lc_data, "height_m")
    )
    # and plot
    ggplotly(ggplot(lc_data, aes(y = height_m)) + geom_boxplot())
    
    # * Check internal validity, e.g.:
    ggplotly(ggplot(lc_data, aes(height_m, prepreg_weight)) +
               geom_point())
    
    #--------------------------------#
    #  b. ('height_mes_m')
    # * Check for correct type [binary], number [two] and definition of categories [0=Self-measured, 1=Measured]
    list(
      data_type = class(lc_data$height_mes_m),
      category_numbers = table(lc_data$height_mes_m),
      summary_stats = summarizeR(lc_data, "height_mes_m")
    )
    
    #------------------------------------------------------------------------------------------------#
    
    # 22. HISTORY OF DIABETES [ALL KINDS] ('prepreg_dia')
    # * NB! This is mother's diagnosis of diabetes BEFORE index pregnancy!
    
    # * Check for correct type [categorical], number [five] and definition of categories [history of diabetes before pregnancy; 1=No, 2=Type1, 3=Type2, 4=Gestational Diabetes, 5=Other/unspecified]
    list(
      data_type = class(lc_data$prepreg_dia),
      category_numbers = table(lc_data$prepreg_dia),
      summary_stats = summarizeR(lc_data, "prepreg_dia")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal history of diabetes before index pregnancy] in your cohort
    
    # * Check internal validity, see below for ILLUSTRATED example with Gestational Diabetes
    CrossTable(lc_data$prepreg_dia, lc_data$preg_dia)
    
    #/*						INCORRECT																	 CORRECT
    #
    #      prepreg_dia |          preg_dia										  prepreg_dia  |          preg_dia
    #	  			  |         0          1 |     Total						   	           |         0          1 |     Total
    #	   -----------+----------------------+----------							-----------+----------------------+----------
    #				1 |   101,114        764 |   101,878 									 1 |   101,114        764 |   101,878
    #				2 |       292       *20* |       312 									 2 |       292        *0* |       292
    #				3 |        34       *15* |        49 									 3 |        34        *0* |        34
    #				4 |       147         85 |       232 									 4 |       147         85 |       232
    #				5 |         4          2 |         6 									 5 |         4          2 |         6
    #	   -----------+----------------------+----------							-----------+----------------------+----------
    #			Total |   101,591        886 |   102,477 				   		         Total |   101,591        851 |   102,442
    
    # Amend, if subjects have a history of diabetes before pregnancy (prepreg_dia=2 or =3) and have gestational diabetes (preg_dia=1) [shown with *]
    
    #------------------------------------------------------------------------------------------------#
    
    # 23. GESTATIONAL DIABETES ('preg_dia')
    # * Gestational Giabetes = Glucose Intolerance with onset or first recognition during pregnancy continuing beyond 24–28 weeks of gestation.
    # * NB! The variable is fully harmonised if data cover the whole pregnancy
    # * If variable is partially harmonised, please check you have documented this accordingly in detail in the online catalogue under 'match'
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$preg_dia),
      category_numbers = table(lc_data$preg_dia),
      summary_stats = summarizeR(lc_data, "preg_dia")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal history of gestational diabetes] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    
    # 24. THYROID DISORDERS DURING PREGNANCY ('preg_thyroid')
    # * NB! The variable is fully harmonised if data cover the whole pregnancy
    # * If variable is partially harmonised, please check you have documented this accordingly in the online catalogue under 'match'
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$preg_thyroid),
      category_numbers = table(lc_data$preg_thyroid),
      summary_stats = summarizeR(lc_data, "preg_thyroid")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal thyroid disorders during pregnancy] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    
    # 25. FEVER DURING PREGNANCY ('preg_fever')
    # * NB! The variable is fully harmonised if data cover the whole pregnancy
    # * If variable is partially harmonised, please check you have documented this accordingly in detail in the online catalogue under 'match'
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    
    list(
      data_type = class(lc_data$preg_thyroid),
      category_numbers = table(lc_data$preg_thyroid),
      summary_stats = summarizeR(lc_data, "preg_thyroid")
    )
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal fever during pregnancy] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    
    # 26. PREECLAMSIA/HELLP SYNDROME ('preeclam')
    # * NB! The variable is fully harmonised if data cover from week 20 until the end of pregnancy
    # * If variable is partially harmonised, please check you have documented this accordingly in detail in the online catalogue under 'match'
    
    
    #  Preeclampsia is defined as :
    #  i) elevated blood pressure after 20 weeks of gestation (≥ 140 mm Hg systolic or ≥ 90 mm Hg diastolic)
    #  ii) proteinuria (> 0.3 g/24 hours).
    #  HELLP Syndrome (haemolysis, elevated liver enzymes, and low platelets) is a manifestation or complication of preeclampsia
    
    #  * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$preeclam),
      category_numbers = table(lc_data$preeclam),
      summary_stats = summarizeR(lc_data, "preeclam")
    )
    
    #* If reasonable, please check the distribution against any previously reported distribution of [preeclamsia] in your cohort
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$preeclam, lc_data$preg_ht) # In LifeCycle, preeclamsia (preeclam) is ranked over gestational hypertension (preg_ht),
    # hence subjects can't be coded '1' in both variables.
    
    #   							   INCORRECT												   CORRECT
    #
    #					   |        preg_ht									     	  |        preg_ht
    #			  preeclam |         0          1 |     Total				 preeclam |         0          1 |     Total
    #			-----------+----------------------+----------			   -----------+----------------------+----------
    #		 			 0 |    57,094      7,203 |    64,297 					    0 |    57,094      8,906 |    66,000
    #				 	 1 |     2,385     *1,703*|     4,088 					    1 |     2,385         *0*|     2,385
    #			-----------+----------------------+----------			   -----------+----------------------+----------
    #				 Total |    59,479      8,906 |    68,385 					Total |    59,479      8,906 |    68,385
    
    # Amend, if subjects have a history of preeclamsia (preeclam=1) and have gestational hypertension (preg_ht=1)[shown with *]
    
    #------------------------------------------------------------------------------------------------#
    
    # 27. GESTATIONAL HYPERTENSION ('preg_ht')
    # * NB! If variable is partially harmonised, please check you have documented this accordingly in the online catalogue under 'match'
    # * (The variable is fully harmonised if data cover from week 20 until the end of pregnancy)
    
    # Gestational hypertension is the new onset of hypertension after 20 weeks of gestation. The diagnosis requires that the patient have:
    #  i) Elevated blood pressure (systolic ≥ 140 or diastolic ≥ 90 mm Hg, the latter measured using the fifth Korotkoff sound)
    #  ii) Previously normal blood pressures
    #  iii) No protein in the urine
    #  iv) No manifestations of preeclampsia
    # Gestational hypertension is diagnosed retrospectively when the patient does not develop preeclampsia and if blood pressure returns to normal by the 12-week postpartum visit
    
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$preg_ht),
      category_numbers = table(lc_data$preg_ht),
      summary_stats = summarizeR(lc_data, "preg_ht")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [gestational hypertension] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    
    # 28. HISTORY OF ASTHMA ('asthma_m')
    # * NB! Asthma should be doctor diagnosed - if not, the variables is partially harmonised - NB! Please, remember to document this accordingly in the Online Catalogue under 'match'
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$asthma_m),
      category_numbers = table(lc_data$asthma_m),
      summary_stats = summarizeR(lc_data, "asthma_m")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [maternal history of asthma] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    
    # 29. PRE-PREGNANCY PSYCHIATRIC DISORDERS ('prepreg_psych')
    # * NB! Document in the Online Catalogue whether the variable is based on details of any psychiatric disorder (i.e. if not, it is partially harmonised)
    # * Visits to a psychologists or psychiatrist should only be used as an indication of a psychiatric disorder if no other data are available
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$prepreg_psych),
      category_numbers = table(lc_data$prepreg_psych),
      summary_stats = summarizeR(lc_data, "prepreg_psych")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [pre-pregnancy psyhicatric disorders]
    
    #------------------------------------------------------------------------------------------------#
    
    # 30. PSYCHIATRIC DISORDERS DURING PREGNANCY ('preg_psych')
    # * NB! Document in the Online Catalogue whether the variable is based on details of any psychiatric disorder (i.e. if not, it is partially harmonised)
    # * Visits to a psychologists or psychiatrist should only be used as an indication of a psychiatric disorder if no other data are available
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$preg_psych),
      category_numbers = table(lc_data$preg_psych),
      summary_stats = summarizeR(lc_data, "preg_psych")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [pregnancy psyhicatric disorders] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    
    # 31. POST-PARTUM DEPRESSION ('ppd')
    # * NB! Document in the Online Catalogue whether PPD is identified using a defined scale or clinically diagnosed (i.e. if not, it is partially harmonised)
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$ppd),
      category_numbers = table(lc_data$ppd),
      summary_stats = summarizeR(lc_data, "ppd")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$ppd, lc_data$mental_exp0)
    
  })

#' Part of maternal characteristics
#' Lifestyle charasteristics
#' This involves variables 32-38
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#'
lc.quality.local.core.maternal.lifestyle.char <-
  local(function(lc_data) {
    message("- Maternal - lifestyle characteristics")
    # 32. PRE-PREGNANCY SMOKING
    # a. ('prepreg_smk')
    # * Check for correct type [binary], number [two] and definition of categories [smoking BEFORE pregnancy; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$prepreg_smk),
      category_numbers = table(lc_data$prepreg_smk),
      summary_stats = summarizeR(lc_data, "prepreg_smk")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$prepreg_smk, lc_data$prepreg_cig)
    
    #--------------------------------#
    #  b. ('prepreg_cig')
    # * NB! Cigars, pipes, cherrots should be converted into cigarettes (1:3), i.e. 1 cigar is equivalent to 3 cigarettes.
    
    # * Check for correct type [categorical], number [three] and definition of categories [cigarettes per day BEFORE pregnancy; 0=0 None, 1=<10 per day, 2≥10 per day]
    list(
      data_type = class(lc_data$prepreg_cig),
      category_numbers = table(lc_data$prepreg_cig),
      summary_stats = summarizeR(lc_data, "prepreg_cig")
    )
    
    #* If reasonable, please check the distribution against cohort-specific published or previously reported distribution of [cigarettes per day before pregnancy]
    
    #------------------------------------------------------------------------------------------------#
    
    # 33. MATERNAL SMOKING DURING PREGNANCY
    # a. ('preg_smk')
    # * Check for correct list of source variables used and for correct coding
    
    # * Check for correct type [binary], number [two] and definition of categories [Smoking during pregnancy; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$preg_smk),
      category_numbers = table(lc_data$preg_smk),
      summary_stats = summarizeR(lc_data, "preg_smk")
    )
    
    #* If reasonable, please check the distribution against cohort-specific published or previously reported distribution of [maternal smoking during pregnancy]
    
    #* Check internal validity with reasonable cross-tabulations // Please, see below for ILLUSTRATED example with cigarettes per day during pregnancy
    CrossTable(lc_data$preg_cig, lc_data$preg_smk)
    
    #								 		INCORRECT 															CORRECT
    
    #preg_cig									       |        		preg_cig
    #preg_smk |         0          1          2 |     Total			  preg_smk |         0          1          2 |     Total
    #-----------+---------------------------------+----------			-----------+---------------------------------+----------
    #  0 |    70,488         *7*        *3*|    70,498			         0 |    70,498         *0*        *0*|    70,498
    #1 |         0     16,868      8,152 |    25,020 					 1 |         0     16,868      8,152 |    25,020
    #-----------+---------------------------------+----------			-----------+---------------------------------+----------
    #  Total |    70,488     16,875      8,155 |    95,518				 Total |    70,498     16,868      8,152 |    95,518
    
    # Amend, if mothers not smoking during pregnancy (preg_smk=0) is coded as smoking any cigarettes during pregnancy (preg_cig=1 or =2) [shown with *]
    
    #--------------------------------#
    #  b. ('preg_cig')
    # * NB! Cigars, pipes, cherrots should be converted into cigarettes (1:3), i.e. 1 cigar is equivalent to 3 cigarettes
    
    # * Check for correct type [categorical], number [three] and definition of categories [cigarettes per day during pregnancy; 0=0 None, 1=<10 per day, 2≥10 per day]
    list(
      data_type = class(lc_data$preg_cig),
      category_numbers = table(lc_data$preg_cig),
      summary_stats = summarizeR(lc_data, "preg_cig")
    )
    
    # * If reasonable, please check the distribution against cohort-specific published or previously reported distribution of [cigarettes per day during pregnancy]
    
    #--------------------------------#
    #  c. ('smk_t1')
    # * Check for correct type [binary], number [two] and definition of categories [Any smoking during 1st trimester: 0=No, 1=Yes]
    list(
      data_type = class(lc_data$smk_t1),
      category_numbers = table(lc_data$smk_t1),
      summary_stats = summarizeR(lc_data, "smk_t1")
    )
    
    # * If reasonable, please check the distribution against cohort-specific published or previously reported distribution of [smoking during 1st trimester of pregnancy]
    
    # * Check internal validity with reasonable cross-tabulations, e.g.:
    CrossTable(lc_data$preg_smk, lc_data$smk_t1)
    
    # 							 INCORRECT											CORRECT
    
    #smk_t1								               smk_t1
    #preg_smk |         0          1 |     Total		  preg_smk |         0          1 |     Total
    #-----------+----------------------+----------		-----------+----------------------+----------
    #  0 |    67,150       *349*|    67,499 			     0 |    67,499         *0*|    67,499
    #1 |       675     23,929 |    24,604 				 1 |       675     23,929 |    24,604
    #-----------+----------------------+----------		-----------+----------------------+----------
    #  Total |    67,825     24,278 |    92,103 			 Total |    68,174     23,929 |    92,103
    
    # Amend, if mothers not smoking during pregnancy (preg_smk=0) is coded as smoking during 1st trimester (smk_t1=1) [shown with *]
    
    
    #--------------------------------#
    #  d. ('smk_t2')
    # * Check for correct type [binary], number [two] and definition of categories [Any smoking during 2nd trimester: 0=No, 1=Yes]
    list(
      data_type = class(lc_data$smk_t2),
      category_numbers = table(lc_data$smk_t2),
      summary_stats = summarizeR(lc_data, "smk_t2")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$preg_smk, lc_data$smk_t2)
    
    #--------------------------------#
    
    #  e. ('smk_t3')
    # * Check for correct type [binary], number [two] and definition of categories [Any smoking during 3rd trimester: 0=No, 1=Yes]
    list(
      data_type = class(lc_data$smk_t3),
      category_numbers = table(lc_data$smk_t3),
      summary_stats = summarizeR(lc_data, "smk_t3")
    )
    
    # * If reasonable, please check the distribution against cohort-specific published or previously reported distribution of [smoking during 3rd trimester of pregnancy]
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$preg_smk, lc_data$smk_t3)
    
    #------------------------------------------------------------------------------------------------#
    
    # 34. PRE-PREGNANCY ALCOHOL INTAKE
    # a. ('prepreg_alc')
    # * Check for correct type [binary], number [two] and definition of categories [Did the mother drink before pregnancy? 0=No, 1=Yes]
    list(
      data_type = class(lc_data$prepreg_alc),
      category_numbers = table(lc_data$prepreg_alc),
      summary_stats = summarizeR(lc_data, "prepreg_alc")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$prepreg_alc_unit, lc_data$prepreg_alc)
    
    #--------------------------------#
    #  b. ('prepreg_alc_unit')
    #* NB! One drink per day corresponds to 7–13 drinks weekly, two drinks per day to 14–20 drinks weekly, etc.
    
    #* Check for correct type [categorical], number [five] and definition of categories [0=0 units/week, 1=<3 units/week, 2=≥3 and <7 units/week,3=≥7 and <14 units/week, 4=≥14 units/week]
    list(
      data_type = class(lc_data$prepreg_alc_unit),
      category_numbers = table(lc_data$prepreg_alc_unit),
      summary_stats = summarizeR(lc_data, "prepreg_alc_unit")
    )
    
    #------------------------------------------------------------------------------------------------#
    
    # 35. MATERNAL ALCOHOL INTAKE DURING PREGNANCY
    # a. ('preg_alc')
    # * Check for correct type [binary], number [two] and definition of categories [Did the mother drink during pregnancy? 0=No, 1=Yes]
    list(
      data_type = class(lc_data$preg_alc),
      category_numbers = table(lc_data$preg_alc),
      summary_stats = summarizeR(lc_data, "preg_alc")
    )
    
    #--------------------------------#
    #  b. ('preg_alc_unit')
    #* NB! One drink per day corresponds to 7–13 drinks weekly, two drinks per day to 14–20 drinks weekly, etc.
    
    #* Check for correct type [categorical], number [four] and definition of categories [0=0 units/week, 1=>0 and <3 units/week, 2=≥3 and <7 units/week,3=≥7 units/week]
    list(
      data_type = class(lc_data$preg_alc_unit),
      category_numbers = table(lc_data$preg_alc_unit),
      summary_stats = summarizeR(lc_data, "preg_alc_unit")
    )
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$preg_alc_unit, lc_data$preg_alc)
    
    #--------------------------------#
    #  c. ('alc_t1')
    #* Check for correct type [binary], number [two] and definition of categories [Any alcohol intake in 1st trimester: 0=No drinking, 1=Yes]
    list(
      data_type = class(lc_data$alc_t1),
      category_numbers = table(lc_data$alc_t1),
      summary_stats = summarizeR(lc_data, "alc_t1")
    )
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$preg_alc, lc_data$alc_t1)
    
    #--------------------------------#
    #  d. ('alc_t2')
    #* Check for correct type [binary], number [two] and definition of categories [Any alcohol intake in 2nd trimester: 0=No drinking, 1=Yes]
    list(
      data_type = class(lc_data$alc_t2),
      category_numbers = table(lc_data$alc_t2),
      summary_stats = summarizeR(lc_data, "alc_t2")
    )
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$preg_alc, lc_data$alc_t2)
    
    #--------------------------------#
    #  e. ('alc_t3')
    #* Check for correct type [binary], number [two] and definition of categories [Any alcohol intake in 3rd trimester: 0=No drinking, 1=Yes]
    list(
      data_type = class(lc_data$alc_t3),
      category_numbers = table(lc_data$alc_t3),
      summary_stats = summarizeR(lc_data, "alc_t3")
    )
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$preg_alc, lc_data$alc_t3)
    
    #------------------------------------------------------------------------------------------------#
    
    # 36. FOLIC ACIDS SUPPLIMENT PRE-CONCEPTION ('folic_prepreg')
    # * NB! BEFORE CONCEPTION!
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$folic_prepreg),
      category_numbers = table(lc_data$folic_prepreg),
      summary_stats = summarizeR(lc_data, "folic_prepreg")
    )
    #------------------------------------------------------------------------------------------------#
    #  37. FOLIC ACIDS SUPPLEMENT WEEK 0-12 ('folic_preg12')
    # * NB! FROM CONCEPTION TO EARLY PREGNANCY, WEEK 12!
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$folic_preg12),
      category_numbers = table(lc_data$folic_preg12),
      summary_stats = summarizeR(lc_data, "folic_preg12")
    )
    
    #------------------------------------------------------------------------------------------------#
    #  38. FOLIC ACIDS SUPPLEMENT WEEK 12+ ('folic_post12')
    # * NB! AFTER WEEK 12 OF PREGNANCY!
    
    # * Check for correct type [binary], number [two] and definition of categories [Folic acids suppl; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$folic_post12),
      category_numbers = table(lc_data$folic_post12),
      summary_stats = summarizeR(lc_data, "folic_post12")
    )
    
  })

#' Part of maternal characteristics
#' Obstetric charasteristics
#' This involves variables 39-45
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#'
lc.quality.local.core.maternal.obstetric.char <-
  local(function(lc_data) {
    message("- Maternal - obstetric characteristics")
    #  39. MATERNAL PARITY ('parity_m')
    # * NB! Please, check that your coding match that still birth is defined as death of a foetus at or after 22 completed weeks of gestation
    # * NB! If both birth medical registry data (BMR) and self-reported data (SP) are available, then BMR is prioritized!
    
    # * Check for correct type [categorical], number [five] and definition of categories [previous born children; 0=0, 1=1, 2=2, 3=3, 4=≥4]
    list(
      data_type = class(lc_data$parity_m),
      category_numbers = table(lc_data$parity_m),
      summary_stats = summarizeR(lc_data, "parity_m")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$agebirth_m_y, lc_data$parity_m)
    
    #------------------------------------------------------------------------------------------------#
    #  40. PLANNED PREGNANCY ('preg_plan')
    # * Check for correct type [binary], number [two] and definition of categories [pregnancy planned or not planned; 1=Yes (planned/partly planned), 2= No (Not planned)]
    list(
      data_type = class(lc_data$preg_plan),
      category_numbers = table(lc_data$preg_plan),
      summary_stats = summarizeR(lc_data, "preg_plan")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [planned pregnancy] of your cohort
    
    #------------------------------------------------------------------------------------------------#
    #  41. ART [ASSISTED REPRODUCTIVE TREATMENT] ('art')
    # * NB! Please, be aware that the definition for this variable has been amended! See Core Variable List for update!
    
    #  * Check for correct type [binary], number [two] and definition of categories [use of ART; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$art),
      category_numbers = table(lc_data$art),
      summary_stats = summarizeR(lc_data, "art")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [ART] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$art, lc_data$preg_plan)
    CrossTable(lc_data$agebirth_m_y, lc_data$art)
    
    #------------------------------------------------------------------------------------------------#
    #  42. IN VITRO-FERTILISATIO [FERTILITY TREATMENT] ('ivf')
    # * NB! Did the mother become pregnant using IVF or ICSI
    
    # * Check for correct type [binary], number [two] and definition of categories [use of IVF or ICSI; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$ivf),
      category_numbers = table(lc_data$ivf),
      summary_stats = summarizeR(lc_data, "ivf")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [IVF] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$ivf, lc_data$preg_plan)
    
    #------------------------------------------------------------------------------------------------#
    #  43. BIRTH OUTCOME ('outcome')
    # * NB! A complete match is achieved when data on all categories (live born, still born, spontaneous abortion etc.) are available
    # * NB! When detailing the match of the variable in the catalogue it is important to include the approximate age of recruitment; in many cases this will explain a partial match.
    # * Where the match is only partial, also indicate whether there are complete data on live-born vs. stillborn
    
    # * Check for correct type [categorical], number [six] and definition of categories [child's condition at delivery; 1=Live-born, 2=Stillborn, 3=Sp. abortion, 4=Induced abortion, 5)Unsp. abortion, 6=Other]
    list(
      data_type = class(lc_data$outcome),
      category_numbers = table(lc_data$outcome),
      summary_stats = summarizeR(lc_data, "outcome")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [Birth Outcome] in your cohort
    
    # * Check internal validity, e.g.: // Please, check that only live-born (outcome=1) has data collected after birth (i.e. at follow-up)
    CrossTable(lc_data$outcome, lc_data$height_1)
    CrossTable(lc_data$outcome, lc_data$weight_1)
    
    #------------------------------------------------------------------------------------------------#
    
    # 44. MODE OF DELIVERY ('mode_delivery')
    # * NB! Complete match achieved when data on all categories are available, otherwise the match is partial. When detailing the match in the catalogue, include details of what data are available.
    # * If variable is partial harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under 'match'
    
    # * Check for correct type [categorical], number [five] and definition of categories [mode of delivery; 1=Vaginal, 2=Forceps, 3=Elective caes., 4=Emergency caes., 5=Unspe. caes.]
    list(
      data_type = class(lc_data$mode_delivery),
      category_numbers = table(lc_data$mode_delivery),
      summary_stats = summarizeR(lc_data, "mode_delivery")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [Mode of Delivery] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    #  45. PLACENTAL ABRUPTION AT DELIVERY ('plac_abrup')
    # * Check for correct type [binary], number [two] and definition of categories [placental abruption at delivery; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$plac_abrup),
      category_numbers = table(lc_data$plac_abrup),
      summary_stats = summarizeR(lc_data, "plac_abrup")
    )
    
  })

#' Part of paternal characteristics
#' Paternal socio-demographic characteristics
#' Involves variables 46-67
#'
#' @section Warning:
#' \enumerate{
#'   \item 46 - occup_f1_?
#'
#'         If a cohort does not have data specifying whether the father is employed or self-employed, categorise the father as employed; the variable will be partially harmonised!. If variable is partially harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under the 'match'. Check for correct type [categorical], number [six] and definition of categories [1=Empl, 2=Self-empl, 3=Unempl, 4=Stud, 5=Domest, 6=Inactive].Also, check for correct number of time bands [eightteen, 0-17]
#'   \item 47 - occup_f1_fath?
#'
#'         Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]. Also, check for correct number of time bands [eightteen, 0-17]
#' }
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#'
lc.quality.local.core.paternal.socio.demo.char <-
  local(function(lc_data) {
    message("- Paternal - social demographic characteristics")
    #  46. PATERNAL OCCUPATIONAL STATUS, PRIMARY FATHER [CORE] ('occup_f1_0-17')
    
    occup_f1_ <-
      c(which(names(lc_data) %in% "occup_f1_0"):which(names(lc_data) %in% "occup_f1_17"))
    
    lc_data[, occup_f1_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occup_f1_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 4, 5, 3, 6)
    
    #------------------------------------------------------------------------------------------------#
    # 47. TYPE OF FATHER, PRIMARY FATHER'S OCCUPATIONAL STATUS [CORE] ('occup_f1_fath0-17')
    occup_f1_fath <-
      c(which(names(lc_data) %in% "occup_f1_fath0"):which(names(lc_data) %in% "occup_f1_fath17"))
    
    lc_data[, occup_f1_fath] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occup_f1_fath] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    #* Check internal validity, e.g.:
    CrossTable(lc_data$occup_f1_fath0, lc_data$occupcode_f1_fath0)
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    # 48. PATERNAL OCCUPATIONAL STATUS, SECONDARY FATHER ('occup_f2_0-17')
    # * NB! If a cohort does not have data specifying whether the father is employed or self-employed, categorise the father as employed; the variable will be partially harmonised!
    # * If variable is partially harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under the 'match'
    
    # * Check for correct type [categorical], number [six] and definition of categories [1=Empl, 2=Self-empl, 3=Unempl, 4=Stud, 5=Domest, 6=Inactive]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    occup_f2_ <-
      c(which(names(lc_data) %in% "occup_f2_0"):which(names(lc_data) %in% "occup_f2_17"))
    
    lc_data[, occup_f2_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occup_f2_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    #* NB! If more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 4, 5, 3, 6)
    
    #------------------------------------------------------------------------------------------------#
    #  49. TYPE OF FATHER, SECONDARY FATHER'S OCCUPATIONAL STATUS [CORE] ('occup_f2_fath0-17')
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    occup_f2_fath <-
      c(which(names(lc_data) %in% "occup_f2_fath0"):which(names(lc_data) %in% "occup_f2_fath17"))
    
    lc_data[, occup_f2_fath] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occup_f2_fath] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Check internal validity with reasonable cross-tabulations // Please, see below for example with other variables with secondary father
    CrossTable(lc_data$occup_f2_fath0, lc_data$occupcode_f2_fath0)
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    #  50. PATERNAL OCCUPATIONAL CODES, PRIMARY FATHER [CORE] ('occupcode_f1_0-17')
    # * NB! If a cohort does not have data specifying whether the father is employed or self-employed, categorise the father as employed; the variable will be partially harmonised!
    # * If variable is partially harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under the 'match'
    
    # * Check for correct type [categorical], number [ten] and definition of categories [0-9]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    
    occupcode_f1_ <-
      c(which(names(lc_data) %in% "occupcode_f1_0"):which(names(lc_data) %in% "occupcode_f1_17"))
    
    lc_data[, occupcode_f1_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occupcode_f1_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 3, 4, 5, 6, 7, 8, 9, 0)
    
    #------------------------------------------------------------------------------------------------#
    
    # 51. TYPE OF FATHER, PRIMARY FATHER'S OCCUPATIONAL CODES [CORE] ('occupcode_f1_fath0-17')
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    occupcode_f1_fath <-
      c(which(names(lc_data) %in% "occupcode_f1_fath0"):which(names(lc_data) %in% "occupcode_f1_fath17"))
    
    lc_data[, occupcode_f1_fath] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occupcode_f1_fath] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Check internal validity with reasonable cross-tabulations // Please, see below for example with other variables with primary father
    CrossTable(lc_data$occupcode_f1_fath0, lc_data$occup_f1_fath0)
    CrossTable(lc_data$occupcode_f1_fath0, lc_data$edu_f1_fath0)
    CrossTable(lc_data$occupcode_f1_fath0, lc_data$cob_p_fath)
    
    #* Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    #  52. PATERNAL OCCUPATIONAL CODES, SECONDARY FATHER [CORE] ('occupcode_f2_0-17')
    # * NB! If a cohort does not have data specifying whether the father is employed or self-employed, categorise the father as employed; the variable will be partially harmonised!
    # * If variable is partially harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under the 'match'
    
    # * Check for correct type [categorical], number [ten] and definition of categories [0-9]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    occupcode_f2_ <-
      c(which(names(lc_data) %in% "occupcode_f2_0"):which(names(lc_data) %in% "occupcode_f2_17"))
    
    lc_data[, occupcode_f2_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occupcode_f2_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 3, 4, 5, 6, 7, 8, 9, 0)
    
    #------------------------------------------------------------------------------------------------#
    # 53. TYPE OF FATHER, SECONDARY FATHER'S OCCUPATIONAL CODES [CORE] ('occupcode_f2_fath0-17')
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    # * Also, also check for correct number of time bands [eightteen, 0-17]
    occupcode_f2_fath <-
      c(which(names(lc_data) %in% "occupcode_f2_fath0"):which(names(lc_data) %in% "occupcode_f2_fath17"))
    
    lc_data[, occupcode_f2_fath] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, occupcode_f2_fath] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Check internal validity, e.g.:
    CrossTable(lc_data$occupcode_f2_fath0, lc_data$edu_f2_fath0)
    
    #* Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    # 54. PATERNAL EDUCATION, PRIMARY FATHER [CORE] ('edu_f1_0-17')
    # * NB! If a cohort does not have data specifying whether the father is employed or self-employed, categorise the father as employed; the variable will be partially harmonised!
    # * If variable is partially harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under the 'match'
    
    # * Check for correct type [categorical], number [three] and definition of categories [Level of education; 1=High, 2=Medium, 3=Low]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    edu_f1_ <-
      c(which(names(lc_data) %in% "edu_f1_0"):which(names(lc_data) %in% "edu_f1_17"))
    
    lc_data[, edu_f1_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, edu_f1_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 3)
    
    #------------------------------------------------------------------------------------------------#
    # 55. TYPE OF FATHER, PRIMARY FATHER's EDUCATION [CORE] ('edu_f1_fath0-17')
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    edu_f1_fath <-
      c(which(names(lc_data) %in% "edu_f1_fath0"):which(names(lc_data) %in% "edu_f1_fath17"))
    
    lc_data[, edu_f1_fath] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, edu_f1_fath] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    #* Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    #  56. PATERNAL EDUCATION, SECONDARY FATHER [CORE] ('edu_f2_0-17')
    # * NB! If a cohort does not have data specifying whether the father is employed or self-employed, categorise the father as employed; the variable will be partially harmonised!
    # * If variable is partially harmonised, please check you have documented the reason for this accordingly in detail in the Online Catalogue under the 'match'
    
    # * Check for correct type [categorical], number [three] and definition of categories [Level of education; 1=High, 2=Medium, 3=Low]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    edu_f2_ <-
      c(which(names(lc_data) %in% "edu_f2_0"):which(names(lc_data) %in% "edu_f2_17"))
    
    lc_data[, edu_f2_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, edu_f2_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the highest measure (according to the following order: 1, 2, 3)
    
    #------------------------------------------------------------------------------------------------#
    # 57. TYPE OF FATHER, SECONDARY FATHER's EDUCATION [CORE] ('edu_f2_fath0-17')
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    edu_f2_fath <-
      c(which(names(lc_data) %in% "edu_f2_fath0"):which(names(lc_data) %in% "edu_f2_fath17"))
    
    lc_data[, edu_f2_fath] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, edu_f2_fath] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(
        category_numbers = table(lc_data[, i]),
        summary_stats = summarizeR(lc_data, i)
      ))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    # 58. PATERNAL COUNTRY OF BIRTH ('cob_p')
    # * Check for correct type [catgorical], number [three] and definition of categories (0=Born in country of cohort, 1=Born in EU country outside cohort country, 2=Born in other country)
    list(
      data_type = class(lc_data$cob_p),
      category_numbers = table(lc_data$cob_p),
      summary_stats = summarizeR(lc_data, "cob_p")
    )
    #------------------------------------------------------------------------------------------------#
    # 59. TYPE OF FATHER, PATERNAL COUNTRY OF BIRTH ('cob_p_fath')
    # * Check for correct list of source variables used and for correct coding
    
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$cob_p_fath),
      category_numbers = table(lc_data$cob_p_fath),
      summary_stats = summarizeR(lc_data, "cob_p_fath")
    )
    
    # * Check reasonable cross-tabulations, e.g.:
    CrossTable(lc_data$cob_p_fath, lc_data$edu_f1_fath0)
    
    #------------------------------------------------------------------------------------------------#
    # 60. PATERNAL ETHNICITY
    # a. ('ethn1_p')
    # * Western countries incl.: EU, Andorra, Australia, New Zealand, Canadata, Iceland, Licechenstein, Monaco, Norway, San Marino, Switzerland, USA, Vatican City.
    # * Non-Western countries incl.: All other countries
    
    # * Check for correct type [catgorical], number [three] and definition of categories  [1=Western, 2=Non-western, 3=Mixed]
    list(
      data_type = class(lc_data$ethn1_p),
      category_numbers = table(lc_data$ethn1_p),
      summary_stats = summarizeR(lc_data, "ethn1_p")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [paternal ethnicity]
    
    #--------------------------------#
    # b. ('ethn2_p')
    # * Check for correct type [catgorical], number [three] and definition of categories [1=Western(Caucasian) , 2=Non-western(non-Caucasion), 3=Mixed]
    list(
      data_type = class(lc_data$ethn2_p),
      category_numbers = table(lc_data$ethn2_p),
      summary_stats = summarizeR(lc_data, "ethn2_p")
    )
    #--------------------------------#
    # c. ('ethn3_p')
    # * Check for correct type [catgorical], number [three] and definition of categories [1=Western, 2=Non-western, 3=Mixed]
    list(
      data_type = class(lc_data$ethn3_p),
      category_numbers = table(lc_data$ethn3_p),
      summary_stats = summarizeR(lc_data, "ethn3_p")
    )
    #------------------------------------------------------------------------------------------------#
    # 61. TYPE OF FATHER, PATERNAL ETHNICITY ('ethn_p_fath')
    # * Check for correct type [catgorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$ethn_p_fath),
      category_numbers = table(lc_data$ethn_p_fath),
      summary_stats = summarizeR(lc_data, "ethn_p_fath")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$ethn_p_fath, lc_data$cob_p_fath)
    CrossTable(lc_data$ethn_p_fath, CrossTable$edu_f1_fath0)
    
    #------------------------------------------------------------------------------------------------#
    # 62. PATERNAL AGE AT BIRTH [YEARS] ('agebirth_p_y')
    # * As this variable is continuous, please check for outliers and impossible values (i.e. typically outside age rage 15-70 years)
    list(
      data_type = class(lc_data$agebirth_p_y),
      summary_stats = summarizeR(lc_data, "agebirth_p_y")
    )
    
    # * If reasonable, please check the distribution against any reported distribution of [paternal age at child's birth] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$agebirth_p_y, lc_data$edu_f1_0)
    
    #------------------------------------------------------------------------------------------------#
    
    # 63. PATERNAL AGE AT BIRTH [DAYS] ('agebirth_p_d')
    # * Please, check for correct list of source variables used and for correct coding (same procedures as with Paternal Age at Birth [Years] above)
    list(
      data_type = class(lc_data$agebirth_p_d),
      summary_stats = summarizeR(lc_data, "agebirth_p_d")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$agebirth_p_d, lc_data$agebirth_p_y)
    
    #------------------------------------------------------------------------------------------------#
    #  64. TYPE OF FATHER, PATERNAL AGE ('agebirth_p_fath')
    # * Check for correct type [catgorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$agebirth_p_fath),
      category_numbers = table(lc_data$agebirth_p_fath),
      summary_stats = summarizeR(lc_data, "agebirth_p_fath")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$agebirth_p_fath, lc_data$cob_p_fath)
    CrossTable(lc_data$agebirth_p_fath, lc_data$edu_f1_fath0)
    CrossTable(lc_data$agebirth_p_fath, lc_data$ethn_p_fath)
    
    #------------------------------------------------------------------------------------------------#
    #  65. PATERNAL DEATH ('death_p')
    # * Check for correct type [binary], number [two] and definition of categories [0=No death of child's father, 1=Yes, death of child's father]
    list(
      data_type = class(lc_data$death_p),
      category_numbers = table(lc_data$death_p),
      summary_stats = summarizeR(lc_data, "death_p")
    )
    #* If reasonable, please check the distribution against any previously reported distribution of [paternal death] of your cohort
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$death_p, lc_data$death_p_age)
    
    #------------------------------------------------------------------------------------------------#
    #  66. AGE OF CHILD AT DEATH OF THE FATHER ('death_p_age')
    # * As this variable is continuous, please check for outliers and impossible values
    list(
      data_type = class(lc_data$death_p_age),
      category_numbers = table(lc_data$death_p_age),
      summary_stats = summarizeR(lc_data, "death_p_age")
    )
    
    #------------------------------------------------------------------------------------------------#
    #  67. TYPE OF FATHER, PATERNAL DEATH ('death_p_fath')
    # * Check for correct type [catgorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$death_p_fath),
      category_numbers = table(lc_data$death_p_fath),
      summary_stats = summarizeR(lc_data, "death_p_fath")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$death_p_fath, lc_data$cob_p_fath)
    CrossTable(lc_data$death_p_fath, lc_data$edu_f1_fath0)
    CrossTable(lc_data$death_p_fath, lc_data$ethn_p_fath)
  })

#' Part of paternal characteristics
#' Paternal health-related characteristics
#' Involves variables 68-76
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#' @importFrom ggplot2 geom_point geom_boxplot
#'
lc.quality.local.core.paternal.health.related.char <-
  local(function(lc_data) {
    message("- Paternal - health related characteristics")
    # workaround to avoid glpobal variable warnings, check: https://stackoverflow.com/questions/9439256/how-can-i-handle-r-cmd-check-no-visible-binding-for-global-variable-notes-when
    weight_f1 <- agebirth_p_y <- height_f1 <- NULL
    
    
    #  68. PATERNAL WEIGHT, PRIMARY FATHER ('weight_f1')
    # * NB! Use measured weight if available, AND... note in the Online Catalogue when data was recorded, i.e. at which follow-up.
    # * If variable is partially harmonised, please check you have documented this accordingly in the online catalogue under 'match'
    
    # * Please, check for outliers and impossible values (e.g. substantial low or high weight in kg)
    list(
      data_type = class(lc_data$weight_f1),
      summary_stats = summarizeR(lc_data, "weight_f1")
    )
    
    # * Check internal validity, e.g.:
    # plot
    ggplotly(lc_data %>%
               ggplot(aes(weight_f1, agebirth_p_y)) +
               geom_point())
    
    # plot
    ggplotly(lc_data %>%
               ggplot(aes(weight_f1, height_f1)) +
               geom_point())
    
    #------------------------------------------------------------------------------------------------#
    #  69. WEIGHT MEASUREMENT, PRIMARY FATHER ('weight_mes_f1')
    # * Check for correct type [catgorical], number [three] and definition of categories [0=Self-reported, 1=Reported by Others, 2=Measured]
    list(
      data_type = class(lc_data$weight_mes_f1),
      category_numbers = table(lc_data$weight_mes_f1),
      summary_stats = summarizeR(lc_data, "weight_mes_f1")
    )
    
    #------------------------------------------------------------------------------------------------#
    #  70. TYPE OF FATHER, PRIMARY FATHER'S WEIGHT ('weight_f1_fath')
    # * Check for correct type [catgorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$weight_f1_fath),
      category_numbers = table(lc_data$weight_f1_fath),
      summary_stats = summarizeR(lc_data, "weight_f1_fath")
    )
    
    # * Check internal validity , e.g.:
    CrossTable(lc_data$weight_f1_fath, lc_data$cob_p_fath)
    CrossTable(lc_data$weight_f1_fath, lc_data$edu_f1_fath0)
    CrossTable(lc_data$weight_f1_fath, lc_data$ethn_p_fath)
    CrossTable(lc_data$weight_f1_fath, lc_data$death_p_fath)
    
    #------------------------------------------------------------------------------------------------#
    # 71. PATERNAL HEIGHT, PRIMARY FATHER ('height_f1')
    # * NB! Use measured height if available!
    
    # * Check for outliers and impossible values (e.g. substantial low or high height, in cm)
    list(
      data_type = class(lc_data$height_f1),
      summary_stats = summarizeR(lc_data, "height_f1")
    )
    
    # And/or plot
    ggplotly(lc_data %>%
               ggplot(aes(y = height_f1)) +
               geom_boxplot())
    #------------------------------------------------------------------------------------------------#
    # 72. HEIGHT MESUREMENT, PRIMARY FATHER ('height_mes_f1')
    # * Check for correct type [catgorical], number [three] and definition of categories [0=Self-reported, 1=Reported by Others, 2=Measured]
    list(
      data_type = class(lc_data$height_mes_f1),
      category_numbers = table(lc_data$height_mes_f1),
      summary_stats = summarizeR(lc_data, "height_mes_f1")
    )
    
    #------------------------------------------------------------------------------------------------#
    # 73. TYPE OF FATHER, PRIMARY FATHER'S HEIGHT ('height_f1_fath')
    # * Check for correct type [catgorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$height_f1_fath),
      category_numbers = table(lc_data$height_f1_fath),
      summary_stats = summarizeR(lc_data, "height_f1_fath")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$height_f1_fath, lc_data$cob_p_fath)
    CrossTable(lc_data$height_f1_fath, lc_data$edu_f1_fath0)
    CrossTable(lc_data$height_f1_fath, lc_data$ethn_p_fath)
    CrossTable(lc_data$height_f1_fath, lc_data$death_p_fath)
    CrossTable(lc_data$height_f1_fath, lc_data$weight_f1_fath)
    
    #------------------------------------------------------------------------------------------------#
    #  74. HISTORY OF DIABETES [BIOLOGICAL FATHER] ('dia_bf')
    # * NB! Please, document in the Online Catalogue whether the type of father was specificed at time of data collection, i.e. whether data definately relate to the biological and not the social father
    
    # * Check for correct type [catgorical], number [four] and definition of categories [1=No, 2=Type1, 3=Type2, 4=Other/unspecified]
    list(
      data_type = class(lc_data$dia_bf),
      category_numbers = table(lc_data$dia_bf),
      summary_stats = summarizeR(lc_data, "dia_bf")
    )
    
    #------------------------------------------------------------------------------------------------#
    #  75. HISTORY OF ASTHMA [BIOLOGICAL FATHER] ('asthma_bf')
    # * NB! Please, document in the Online Catalogue whether the type of father was specificed at time of data collection, i.e. whether data definately relate to the biological and not the social father
    
    # * Check for correct type [binary], number [two] and definition of categories [1=No, 2=Yes]
    list(
      data_type = class(lc_data$asthma_bf),
      category_numbers = table(lc_data$asthma_bf),
      summary_stats = summarizeR(lc_data, "asthma_bf")
    )
    
    #------------------------------------------------------------------------------------------------#
    #  76. HISTORY OF PSYCHIATRIC DISORDER [BIOLOGICAL FATHER] ('psych_bf')
    # * NB! Please, document in the Online Catalogue whether the type of father was specificed at time of data collection, i.e. whether data definately relate to the biological and not the social father
    # * NB! Document in the Online Catalogue exactly whether the variable is based on details of any psychiatric disorder (i.e. if not, it is partially harmonised)
    
    # * Check for correct type [binary], number [two] and definition of categories [0=No, 1=Yes]
    list(
      data_type = class(lc_data$psych_bf),
      category_numbers = table(lc_data$psych_bf),
      summary_stats = summarizeR(lc_data, "psych_bf")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$psych_bf, lc_data$mental_exp0)
    
  })

#' Part of paternal characteristics
#' Paternal lifestyle characteristics
#' Involves variables 77-78
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#'
lc.quality.local.core.paternal.lifestyle.char <-
  local(function(lc_data) {
    message("- Paternal - lifestyle characteristics")
    #  77. PATERNAL SMOKING DURING PREGNANCY
    # a. ('smk_p')
    # * Check for correct type [binary], number [two] and definition of categories [smoking during pregnancy; 0=No, 1=Yes]
    list(
      data_type = class(lc_data$smk_p),
      category_numbers = table(lc_data$smk_p),
      summary_stats = summarizeR(lc_data, "smk_p")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [paternal smoking during pregnancy] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$smk_cig_p, lc_data$smk_p)
    
    #--------------------------------#
    # b. ('smk_cig_p')
    # * NB! Convertion: 1 cigar, pipe, cheroots etc. is equivalent to 3 cigarettes.
    
    # * Check for correct type [categorical], number [three] and definition of categories [cigarettes per day during pregnancy; 0=0 None, 1=<10 per day, 2≥10 per day]
    list(
      data_type = class(lc_data$smk_cig_p),
      category_numbers = table(lc_data$smk_cig_p),
      summary_stats = summarizeR(lc_data, "smk_cig_p")
    )
    
    #------------------------------------------------------------------------------------------------#
    #  78. TYPE OF FATHER, PATERNAL SMOKING DURING PREGNANCY ('smk_fath')
    # * Check for correct type [categorical], number [four] and definition of categories [Type of father; 1=Biological father, 2=Social father, 3=Social mother, 4=Unknown]
    list(
      data_type = class(lc_data$smk_fath),
      category_numbers = table(lc_data$smk_fath),
      summary_stats = summarizeR(lc_data, "smk_fath")
    )
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$smk_fath, lc_data$cob_p_fath)
  })

#' Part of child characteristics
#' Child birth outcomes
#' Involves variables 79-97
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#' @importFrom ggplot2 ggplot aes geom_point geom_boxplot
#' @importFrom dplyr filter
#'
lc.quality.local.core.child.birth.out <- local(function(lc_data) {
  message("- Child - birth outcomes")
  # workaround to avoid glpobal variable warnings, check: https://stackoverflow.com/questions/9439256/how-can-i-handle-r-cmd-check-no-visible-binding-for-global-variable-notes-when
  ga_lmp <-
    ga_us <-
    ga_mr <-
    ga_bj <-
    outcome <-
    birth_weight <-
    birth_length <-
    birth_head_circum <- plac_weight <- weight_who_ga <- . <- NULL
  
  #------------------------------------------------------------------------------------------------#
  # 79. BIRTH MONTH ('birth_month')
  # * Check for correct type [catgorical], number [twelve] and definition of categories [calender month, 1-12]
  list(
    data_type = class(lc_data$birth_month),
    category_numbers = table(lc_data$birth_month),
    summary_stats = summarizeR(lc_data, "birth_month")
  )
  
  #------------------------------------------------------------------------------------------------#
  #  80. BIRTH YEAR ('birth_year')
  # * Check for outliers and impossible values (e.g. soutside of data collection)
  list(
    data_type = class(lc_data$birth_year),
    category_numbers = table(lc_data$birth_year),
    summary_stats = summarizeR(lc_data, "birth_year")
  )
  
  #------------------------------------------------------------------------------------------------#
  # 81. APGAR SCORE ('apgar')
  # * NB! 10-minute Apgar score can be used if 5-minute Apgar score is not available; this will be partial harmonisation and should be detailed in the online catalogue
  # * NB! Be aware, that 1-minute Apgar score cannot be used in place of 5-minute Apgar-score
  
  # * Check for correct type [catgorical], number [ten] and definition of categories [apgar-score, 1-10]
  list(
    data_type = class(lc_data$apgar),
    category_numbers = table(lc_data$apgar),
    summary_stats = summarizeR(lc_data, "apgar")
  )
  
  # * If reasonable, please check the distribution against any published or previously reported distribution of [apgar score] in your cohort
  
  # * Check internal validity, e.g.:
  CrossTable(lc_data$apgar, lc_data$outcome)
  
  #------------------------------------------------------------------------------------------------#
  # 82. TRANSFERRED TO NEONATAL UNIT ('neo_unit')
  # * NB! Any transfer to a neonatal unit within the first week of life
  
  # * Check for correct type [binary], number [two] and definition of categories [transfer; 0=No, 1=Yes]
  list(
    data_type = class(lc_data$neo_unit),
    category_numbers = table(lc_data$neo_unit),
    summary_stats = summarizeR(lc_data, "neo_unit")
  )
  
  # * Check internal validity, e.g.:
  CrossTable(lc_data$neo_unit, lc_data$outcome)
  
  #										INCORRECT																						  CORRECT
  
  #|                             outcome 															 |                             outcome
  # neo_unit | live born  still bor  spontaneo  induced a      other          . |     Total			neo_unit | live born  still bor  spontaneo  induced a      other          . |     Total
  # -----------+------------------------------------------------------------------+----------		  -----------+------------------------------------------------------------------+----------
  #   0 |    88,007          0         *0*        *0*        *0*         0 |    88,007 				   0 |    88,007          0         *0*        *0*        *0*         0 |    88,007
  # 1 |     8,668          0        *10*        *7*        *3*         0 |     8,688 				   1 |     8,688          0         *0*        *0*        *0*         0 |     8,688
  # . |       139        329      4,739        443        114         76 |     5,840 				   . |       139        329      4,739        443        114         76 |     5,840
  # -----------+------------------------------------------------------------------+----------		  -----------+------------------------------------------------------------------+----------
  #   Total |    96,814        329      4,749        450        117         76 |   102,535 			   Total |    96,834        329      4,739        443        114         76 |   102,535
  
  # Amend, only subjects live-born should have values in neo_unit, all others should be coded as missing (neo_unit=.) [shown with *]
  
  #------------------------------------------------------------------------------------------------#
  # 83. SEX ('sex')
  # * Check for correct type [binary], number [two] and definition of categories [sex; 1=Male, 2=Female]
  list(
    data_type = class(lc_data$sex),
    category_numbers = table(lc_data$sex),
    summary_stats = summarizeR(lc_data, "sex")
  )
  
  #* If reasonable, please check the distribution against any previously reported distribution of [sex] in your cohort
  
  #------------------------------------------------------------------------------------------------#
  #  84. PLURALITY ('plurality')
  # * Check for correct type [catgorical], number [three] and definition of categories [number of foetuses in pregnancy; 1=Single, 2=Twin, 3=Triplets]
  list(
    data_type = class(lc_data$plurality),
    category_numbers = table(lc_data$plurality),
    summary_stats = summarizeR(lc_data, "plurality")
  )
  
  # * If reasonable, please check the distribution against cohort-specific published or previously reported distribution of [plurality]
  
  #------------------------------------------------------------------------------------------------#
  #  85. GESTATIONAL AGE [LAST MENSTRUAL PERIOD] ('ga_lmp')
  # * NB! Convertion: If GA is reported in weeks then recalculate: n (weeks) x 7 + 3.5 // Example: 40 weeks x 7 + 3.5 = 283.5
  
  # * Check for outliers and impossible values (negative values or > 315, in days)
  list(
    data_type = class(lc_data$ga_lmp),
    category_numbers = table(lc_data$ga_lmp),
    summary_stats = summarizeR(lc_data, "ga_lmp")
  )
  
  # * If reasonable, please check the summary statistics against any previously reported distribution of [gestational age using LMP] in your cohort
  
  # * Check internal validity, e.g. // there should not be huge inconsistencies between the measures
  ggplotly(lc_data %>%
             ggplot(aes(ga_lmp, ga_us)) +
             geom_point())
  
  ggplotly(lc_data %>%
             ggplot(aes(ga_lmp, ga_mr)) +
             geom_point())
  
  ggplotly(lc_data %>%
             ggplot(aes(ga_lmp, ga_bj)) +
             geom_point())
  #------------------------------------------------------------------------------------------------#
  # 86. GESTATIONAL AGE [ULTRA SOUND] ('ga_us')
  # * NB! Convertion: If GA is reported in weeks then recalculate: n (weeks) x 7 + 3.5 // Example: 40 weeks x 7 + 3.5 = 283.5
  
  # * As this variable is continuous, please check for outliers and impossible values (negative values or > 315, in days)
  list(
    data_type = class(lc_data$ga_us),
    summary_stats = summarizeR(lc_data, "ga_us")
  )
  
  # * If reasonable, please check the summary statistics against any previously reported distribution of [gestational age using ulstra sound] in your cohort
  
  # * Check internal validity, e.g. // there should not be huge inconsistencies between the measures
  ggplotly(lc_data %>%
             ggplot(aes(ga_us, ga_mr)) +
             geom_point())
  
  ggplotly(lc_data %>%
             ggplot(aes(ga_us, ga_bj)) +
             geom_point())
  
  #------------------------------------------------------------------------------------------------#
  # 87. GESTATIONAL AGE [MATERNAL REPORT] ('ga_mr')
  # * NB! Convertion: If GA is reported in weeks then recalculate: n (weeks) x 7 + 3.5 // Example: 40 weeks x 7 + 3.5 = 283.5
  
  # * Check for outliers and impossible values (negative values or > 315, in days)
  list(
    data_type = class(lc_data$ga_mr),
    summary_stats = summarizeR(lc_data, "ga_mr")
  )
  
  # * If reasonable, please check the summary statistics against any previously reported distribution of [gestational age using medical record] in your cohort
  
  # * Check internal validity, e.g. // there should not be huge inconsistencies between the measures
  ggplotly(lc_data %>%
             ggplot(aes(ga_mr, ga_bj)) +
             geom_point())
  #------------------------------------------------------------------------------------------------#
  # 88. GESTATIONAL AGE [BEST JUDGEMENT] ('ga_bj')
  # * NB! Convertion: If GA is reported in weeks then recalculate: n (weeks) x 7 + 3.5 // Example: 40 weeks x 7 + 3.5 = 283.5
  # Priority:
  #   1) Use LMP if difference from US is less than 7 days or if US is not available
  #   2) Difference between LMP and US more than 7 days --> use US
  #   3) If LMP is not available use US
  #   4) Non of them available - use maternal report.
  
  
  # * Check for outliers and impossible values (negative values, or > 315, in days)
  list(
    data_type = class(lc_data$ga_bj),
    summary_stats = summarizeR(lc_data, "ga_bj")
  )
  
  # * If reasonable, please check the summary statistics against any previously reported distribution of [gestational age using best judgement] in your cohort
  
  #------------------------------------------------------------------------------------------------#
  #  89. BIRTH WEIGHT ('birth_weight')
  # * Please, check for outliers and impossible values (e.g. negative, or substantial low or high values, in kg)
  list(
    data_type = class(lc_data$ga_bj),
    summary_stats = summarizeR(lc_data, "ga_bj")
  )
  
  lc_data %>%
    filter(outcome == 1) %>%
    select(birth_weight) %>%
    summarizeR(., "birth_weight")
  
  
  # * If reasonable, please check the summary statistics against any previously reported distribution of [birth weight] in your cohort
  
  # * Check internal validity, e.g.:
  ggplotly(lc_data %>%
             ggplot(aes(birth_weight, ga_lmp)) +
             geom_point())
  
  ggplotly(lc_data %>%
             ggplot(aes(birth_weight, birth_length)) +
             geom_point())
  
  ggplotly(lc_data %>%
             ggplot(aes(
               y = birth_length,
               x = factor(outcome),
               col = factor(outcome)
             )) +
             geom_boxplot())
  
  #------------------------------------------------------------------------------------------------#
  # 90. BIRTH LENGTH ('birth_length')
  # * Please, check for outliers and impossible values (e.g. negative, or substantial low or high values, in cm)
  list(
    data_type = class(lc_data$birth_length),
    summary_stats = summarizeR(lc_data, "birth_length")
  )
  
  lc_data %>%
    filter(outcome == 1) %>%
    select(birth_length) %>%
    summarizeR(., "birth_length")
  
  # * If reasonable, please check the summary statistics against any previously reported distribution of [height at birth of child] in your cohort
  
  # * Check internal validity, e.g.:
  ggplotly(lc_data %>%
             ggplot(aes(birth_length, ga_lmp)) +
             geom_point())
  
  ggplotly(lc_data %>%
             ggplot(aes(
               y = birth_length,
               x = factor(outcome),
               col = factor(outcome)
             )) +
             geom_boxplot())
  
  #------------------------------------------------------------------------------------------------#
  # 91. BIRTH HEAD CIRCUMFERENCE ('birth_head_circum')
  # * Please check for outliers and impossible values (e.g. negative, or substantial low or high values, in cm)
  list(
    data_type = class(lc_data$birth_length),
    summary_stats = summarizeR(lc_data, "birth_head_circum")
  )
  
  lc_data %>%
    filter(outcome == 1) %>%
    select(birth_head_circum) %>%
    summarizeR(., "birth_head_circum")
  
  # * If reasonable, please check the distribution against any previously reported distribution of [head circumference of child at birth] in your cohort
  
  # * Check internal validity, e.g.:
  CrossTable(lc_data$birth_head_circum, lc_data$outcome)
  
  #-----------------------------------------------------------------------------------------------#
  # 92. SIZE FOR GESTATIONAL AGE ('weight_who_ga')
  # * NB! Defined using the WHO foetal growth charts (Kiserud et al 2017) using the 5th and 95th percentiles as cut-off values for SGA and LGA respectively.
  # * NB! Please, Check that you have classified a child as SGA if birth weight is <= 5th percentile for GA (completed weeks)
  # * NB! Please, Check that you have classified a child as LGA if birth weight is >= 95th percentile for GA (completed weeks)
  # * As an example, a female born at 32 weeks + 2 days weighing 1,530g will be classified as SGA. A male born at 37 weeks + 5 days weighing 3,598 will be classified as LGA.
  
  # * If variable is partially harmonised, please check you have documented this accordingly in the online catalogue under 'match'
  
  # * Check for correct type [catgorical], number [three] and definition of categories [Size for Gestational Age, 1=SGA (Small for GA), 2=AGA (Appropriate for GA), 3=LGA (Large for GA)]
  list(
    data_type = class(lc_data$weight_who_ga),
    category_numbers = table(lc_data$weight_who_ga),
    summary_stats = summarizeR(lc_data, "weight_who_ga")
  )
  
  lc_data %>%
    select(weight_who_ga) %>%
    summarizeR(., "weight_who_ga")
  
  # * If reasonable, please check the distribution against any previously reported distribution of [size for gestational age]
  
  #------------------------------------------------------------------------------------------------#
  #  93. PLACENTA WEIGHT ('plac_weight')
  # * Check for outliers and impossible values (e.g. negative, or substantial low or high values, in kg)
  list(
    data_type = class(lc_data$plac_weight),
    summary_stats = summarizeR(lc_data, "plac_weight")
  )
  
  # * If reasonable, please check the summary statistics against cohort-specific published or previously reported distribution of [placenta weight]
  
  # * Check internal validity, e.g.:
  ggplotly(lc_data %>%
             ggplot(aes(plac_weight, birth_weight)) +
             geom_point())
  
  #------------------------------------------------------------------------------------------------#
  #  94. ANY CONGENITAL ANOMALY ('con_anomalies')
  # * Check for correct type [binary], number [two] and definition of categories [Any congential malformation, 0=No, 1=Yes]
  list(
    data_type = class(lc_data$con_anomalies),
    category_numbers = table(lc_data$con_anomalies),
    summary_stats = summarizeR(lc_data, "con_anomalies")
  )
  
  #* If reasonable, please check the summary statistics against any previously reported distribution of [any congenital anomaly] in your cohort
  
  #------------------------------------------------------------------------------------------------#
  #  95. SEVERE CONGENITAL ANOMALY ('major_con_anomalies')
  # * NB! According to EUROCAT guide 1.4, Table 3.3 (http://www.eurocat-network.eu/content/Full%20Guide%201%204%20version%2008_Sept2017.pdf)
  # * If variable is partially harmonised, please check you have documented this accordingly in detail in the online catalogue under 'match'
  
  # * Check for correct type [binary], number [two] and definition of categories [Any congential malformation, 0=No, 1=Yes]
  list(
    data_type = class(lc_data$major_con_anomalies),
    category_numbers = table(lc_data$major_con_anomalies),
    summary_stats = summarizeR(lc_data, "major_con_anomalies")
  )
  
  #* If reasonable, please check the summary statistics against any previously reported distribution of [major congenital anomaly] in your cohort
  
  #* Check internal validity, e.g.:
  CrossTable(lc_data$major_con_anomalies, lc_data$con_anomalies)
  
  # 						INCORRECT											                     CORRECT
  
  # major_con_ |     con_anomalies									    major_con_ |     con_anomalies
  # anomalies  |         0          1 |     Total						anomalies  |         0          1 |     Total
  # -----------+----------------------+----------					    -----------+----------------------+----------
  #   0 |    97,667      1,650 |    99,317 						         0 |    97,667      1,650 |    99,317
  #   1 |      *102*     3,108 |     3,210 						         1 |       *0*      3,210 |     3,210
  # -----------+----------------------+----------					    -----------+----------------------+----------
  #   Total |    97,769      4,860 |   102,527 						     Total |    97,667      4,860 |   102,527
  
  # Amend, if subjects with severe congenital anomalies (major_con_anomalies=1) is coded with no congenital anomaly (con_anomalies=0) [shown with *]
  
  
  #------------------------------------------------------------------------------------------------#
  # 96. CEREBRAL PALSY ('cer_palsy')
  # * Check for correct type [binary], number [two] and definition of categories [Any subtype of cerebral palsy, 0=No, 1=Yes]
  list(
    data_type = class(lc_data$cer_palsy),
    category_numbers = table(lc_data$cer_palsy),
    summary_stats = summarizeR(lc_data, "cer_palsy")
  )
  
  #* If reasonable, please check the distribution against any previously reported distribution of [cerebral palsy] in your cohort
  
  #------------------------------------------------------------------------------------------------#
  # 97. SIBLING POSITION ('sibling_pos')
  # * If variable is partially harmonised, please check you have documented this accordingly in detail in the online catalogue under 'match'
  
  # * Check for correct type [categorical], number [five] and definition of categories [sibling position, 1=1, 2=2, 3=3, 4=4, 5=≥5]
  list(
    data_type = class(lc_data$sibling_pos),
    category_numbers = table(lc_data$sibling_pos),
    summary_stats = summarizeR(lc_data, "sibling_pos")
  )
  
  # * If reasonable, please check the distribution against any previously reported distribution of [sibling position] in your cohort
})

#' Part of child characteristics
#' Child health-related characteristics
#' Involves variables 98-103
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#' @importFrom ggplot2 geom_point
#' @importFrom dplyr select_if mutate group_by arrange lag
#' @importFrom tidyr spread
#'
lc.quality.local.core.child.health.related.char <-
  local(function(lc_data) {
    message("- Child - health related characterisics")
    # workaround to avoid glpobal variable warnings, check: https://stackoverflow.com/questions/9439256/how-can-i-handle-r-cmd-check-no-visible-binding-for-global-variable-notes-when
    birth_length <-
      height_0 <-
      child_id <-
      coh_country <-
      height_215 <-
      orig_var <-
      variable_trunc <-
      age_months <- prev <- height_diff <- birth_weight <- . <- NULL
    
    #------------------------------------------------------------------------------------------------#
    # 98. DEATH OF CHILD ('death_child')
    # * Check for correct type [binary], number [two] and definition of categories [Death of child, 0=No, 1=Yes]
    list(
      data_type = class(lc_data$death_child),
      category_numbers = table(lc_data$death_child),
      summary_stats = summarizeR(lc_data, "death_child")
    )
    
    # * If reasonable, please check summary statistics against any previously reported distribution of [death of child] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$death_child, lc_data$death_child_age)
    CrossTable(lc_data$death_child, lc_data$outcome)
    
    #------------------------------------------------------------------------------------------------#
    # 99. AGE OF DEATH OF CHILD ('death_child_age')
    # * NB! Only relevant for deceased children
    
    # * Check for outliers and impossible values [NB! must have positive values]
    list(
      data_type = class(lc_data$death_child_age),
      summary_stats = summarizeR(lc_data, "death_child_age")
    )
    
    #------------------------------------------------------------------------------------------------#
    # 100. CHILD's HEIGHT ('height_0-215')
    # * Please, check for outliers and impossible values [negative, or substantial low or high length, in cm]
    
    # * Please, check for correct number of time bands [twohundredandsixteen, 0-215], where "0" is child's height measured between the ages of 0 and <1 month. This does not include the child's birth length
    height_ <-
      c(which(names(lc_data) %in% "height_0"):which(names(lc_data) %in% "height_17"))
    
    lc_data[, height_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, height_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
      
    }
    #* If reasonable, please check the distribution any previously reported distribution of [child's height] in your cohort
    
    # * Check internal validity, e.g.:
    ggplotly(lc_data %>%
               ggplot(aes(x = birth_length, y = height_0)) +
               geom_point())
    
    #* NB! For this variable, it is important to check whether ID change category when not reasonable (i.e. a descrease in height over time, e.g. from height_4 to height_8)
    lc_data %>%
      #select heiight variables and cohort specific variables
      select(child_id:coh_country, height_0:height_215) %>%
      # drop all columns with all missing values
      select_if(function(x) {
        !all(is.na(x))
      }) %>%
      #reshape to long format
      gather(orig_var, height_, grep("height_", names(.)), na.rm = FALSE) %>%
      # generate a month variable
      mutate(age_months = as.numeric(numextract(orig_var))) %>%
      #take out the month indicator from the height variable
      mutate(variable_trunc = gsub('[[:digit:]]+$', '', orig_var)) %>% #take out the year indicator from the education variable
      spread(key = variable_trunc, value = height_) %>%
      #group the data by child ID so the differences in height are only calculated within one ID, and not across all IDs
      group_by(child_id) %>%
      arrange(child_id, age_months) %>%
      # this creates a variable with values indicating the previous value of height_
      mutate(prev = lag(height_, order_by = child_id)) %>%
      # create a variable that indicates the difference between the previous value and teh value one year later.
      # If this value is negative, that means the education level decreased over time, which is not plausible
      mutate(height_diff = height_ - prev) %>%
      # here we take the subset of the data, that has implausible values. Check the ID's and height_X variables for errors
      subset(., height_diff <  0)
    
    #* Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    #  101. AGE WHEN CHILD's HEIGHT RECORDED ('height_age0-215')
    # * Please, check for outliers and impossible values [e.g. for height_age0 values must be within 0-29 (days)]
    
    # * Also, check for correct number of time bands [twohundredandsixteen, 0-215], where "0" is height measured between the ages of 0 and <1 month
    height_age <-
      c(which(names(lc_data) %in% "height_age0"):which(names(lc_data) %in% "height_age215"))
    
    lc_data[, height_age] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, height_age] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the measure clostest to the lowest cut-off, e.g. for height_age0 use the measure closest to the value '0' and for height_age1 use the measure closest to the value '30')
    
    #------------------------------------------------------------------------------------------------#
    # 102. CHILD's WEIGHT ('weight_0-215')
    # * Please, check for outliers and impossible values [negative, or substantial low or high length, in kg]
    
    # * Also, check for correct number of time bands [twohundredandsixteen, 0-215], where "0" is weight measured between the ages of 0 and <1 month
    weight_ <-
      c(which(names(lc_data) %in% "weight_0"):which(names(lc_data) %in% "weight_215"))
    
    lc_data[, weight_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, weight_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
      
    }
    # * If reasonable, please check the distribution against any previously reported distribution of [child's weight] in your cohort
    
    # * Check internal validity, e.g.:
    ggplotly(lc_data %>%
               ggplot(aes(birth_weight, lc_data$weight_0)) +
               geom_point())
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    
    #------------------------------------------------------------------------------------------------#
    # 103. AGE WHEN CHILD's WEIGHT RECORDED ('weight_age0-215')
    # * Please, check for outliers and impossible values [e.g. for height_age0 values must be within 0-29 (days)]
    # * Also, check for correct number of time bands [twohundredandsixteen, 0-215], where "0" is weight measured between the ages of 0 and <1 month
    weight_age <-
      c(which(names(lc_data) %in% "weight_age0"):which(names(lc_data) %in% "weight_age215"))
    
    lc_data[, weight_age] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, weight_age] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the measure clostest to the lowest cut-off, e.g. for weight_age0 use the measure closest to the value '0' and for weight_age1 use the measure closest to the value '30')
  })

#' Part of child characteristics
#' Child exposures/lifestyle/environment
#' Involves variables 104-115
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#'
lc.quality.local.core.child.exposure.lifestyle.environ.char <-
  local(function(lc_data) {
    message("- Child - exposure lifestyle environment characterisics")
    # 104. EXCLUSIVE BREAST-FEEDING ('breastfed_excl')
    # * NB! Upper limit of 6 months; durations greater than 6 months assigned the value 6 months. Children never breastfed will have a duration of 0 months!
    
    # * Check for outliers and impossible values [e.g. negative values or values >6, in months]
    list(
      data_type = class(lc_data$breastfed_excl),
      category_numbers = table(lc_data$breastfed_excl),
      summary_stats = summarizeR(lc_data, "breastfed_excl")
    )
    
    #* If reasonable, please check the distribution against any previously reported distribution of [exclusive breast-feeding] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$breastfed_excl, lc_data$breastfed_ever)
    
    #------------------------------------------------------------------------------------------------#
    # 105. ANY BREST-FEEDING ('breastfed_any')
    # * NB! Upper limit of 12 months; durations greater than 12 months assigned the value 12 months. Children never breastfed will have a duration of 0 months!
    
    # * Check for outliers and impossible values [e.g. negative values or values >12, in months]
    list(
      data_type = class(lc_data$breastfed_any),
      category_numbers = table(lc_data$breastfed_any),
      summary_stats = summarizeR(lc_data, "breastfed_any")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [any breast-feeding] in your cohort
    
    # * Check internal validity, e.g.:
    CrossTable(lc_data$breastfed_any, lc_data$breastfed_ever)
    
    #------------------------------------------------------------------------------------------------#
    # 106. EVER BREST-FED ('breastfed_ever')
    # * Check for correct type [binary], number [two] and definition of categories [child ever breastfed, 0=No, never breastfed; 1=Yes, ever breastfed]
    list(
      data_type = class(lc_data$breastfed_ever),
      category_numbers = table(lc_data$breastfed_ever),
      summary_stats = summarizeR(lc_data, "breastfed_ever")
    )
    
    # * If reasonable, please check the distribution against any previously reported distribution of [ever breast-feeding] of your cohort
    
    #------------------------------------------------------------------------------------------------#
    # 107. SOLID FOOD INTRODUCTION ('solid_food')
    # * NB! Upper limit of 6 months; durations greater than 6 months assigned the value 6 months!
    
    # * Check for outliers and impossible values [e.g. negative values or values >6, in months]
    list(
      data_type = class(lc_data$solid_food),
      category_numbers = table(lc_data$solid_food),
      summary_stats = summarizeR(lc_data, "solid_food")
    )
    
    #* If reasonable, please check the distribution against any previously reported distribution of [age of the child when solid food was introduced] in your cohort
    
    #------------------------------------------------------------------------------------------------#
    # 108. CHILD CARE INTRODUCTION ('childcare_intro')
    # * Check for correct list of source variables used and check for correct coding
    
    # * Check for outliers and impossible values [i.e. negative values or values above 3 years]
    list(
      data_type = class(lc_data$childcare_intro),
      category_numbers = table(lc_data$childcare_intro),
      summary_stats = summarizeR(lc_data, "childcare_intro")
    )
    
    #-----------------------------------------------------------------------------------------------#
    # 109. CHILD CARE ('childcare_0-3')
    # * NB! Cared for by care givers other than parents of the child!
    
    # * Check for correct type [binary], number [two] and definition of categories [0= No Childcare, 1=Childcare]
    
    # * Please, check for correct number of time bands [four, 0-3], where "0" is within 1st year of life, and "1" is within 2nd year of life
    childcare_ <-
      c(which(names(lc_data) %in% "childcare_0"):which(names(lc_data) %in% "childcare_3"))
    
    lc_data[, childcare_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, childcare_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
      
    }
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the measure clostest to the child's first (not latter) birthday, e.g. for childcare_0 use the measure clostest to child's birth and for childcare_1 use the measure closest to child's first birthday)
    
    #------------------------------------------------------------------------------------------------#
    # 110. CARED FOR BY RELATIVES, FRIENDS, NANNY OR AU-PAIR ('childcarerel_0-3')
    # * Check for correct type [binary], number [two] and definition of categories [0= Not cared for by friends, relatives etc.; 1= Cared for by friends, relatives etc.]
    # * Also, check for correct number of time bands [four, 0-3], where "0" is within 1st year of life, and "1" is within 2nd year of life
    childcarerel_ <-
      c(which(names(lc_data) %in% "childcarerel_0"):which(names(lc_data) %in% "childcarerel_3"))
    
    lc_data[, childcarerel_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, childcarerel_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
      
    }
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the measure clostest to the child's first (not latter) birthday, e.g. for childcare_0 use the measure clostest to child's birth and for childcare_1 use the measure closest to child's first birthday)
    
    #------------------------------------------------------------------------------------------------#
    # 111. CARED FOR BY PROFESSIONAL CHILD MINDER ('childcareprof_0-3')
    # * Check for correct type [binary], number [two] and definition of categories [0= Not cared for by professional child minder, relatives etc.; 1= Cared for by professional child minder]
    # * Also, check for correct number of time bands [four, 0-3], where "0" is within 1st year of life, and "1" is within 2nd year of life
    childcareprof_ <-
      c(which(names(lc_data) %in% "childcareprof_0"):which(names(lc_data) %in% "childcarerel_3"))
    
    lc_data[, childcareprof_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, childcareprof_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
    }
    
    #* Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    #* NB! If more than one measure declared within the period, use the measure clostest to the child's first (not latter) birthday, e.g. for childcare_0 use the measure clostest to child's birth and for childcare_1 use the measure closest to child's first birthday)
    
    #------------------------------------------------------------------------------------------------#
    # 112. CENTRE-BASED DAY CARE/NUSERY/KIDNERGARTEN ('childcarecentre_0-3')
    # * Check for correct type [binary], number [two] and definition of categories [0= Not attending a day care center; 1= Attending a day care center]
    # * Also, check for correct number of time bands [four, 0-3], where "0" is within 1st year of life, and "1" is within 2nd year of life
    childcarecentre_ <-
      c(which(names(lc_data) %in% "childcarecentre_0"):which(names(lc_data) %in% "childcarecentre_3"))
    
    lc_data[, childcarecentre_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, childcarecentre_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
    }
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the measure clostest to the child's first (not latter) birthday, e.g. for childcare_0 use the measure clostest to child's birth and for childcare_1 use the measure closest to child's first birthday)
    
    #------------------------------------------------------------------------------------------------#
    # 113. CHILD's EXPOSURES TO PASSIVE SMOKING ('smk_exp0-17')
    # * NB! Any exposure to smoking in the home (by mother/biological father/social father or any other smokers close to the child)
    
    # * Check for correct type [binary], number [two] and definition of categories [Any exposure to smoking; 0= No, 1= Yes]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    smk_exp <-
      c(which(names(lc_data) %in% "smk_exp0"):which(names(lc_data) %in% "smk_exp17"))
    
    lc_data[, smk_exp] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, smk_exp] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
    }
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the following priorization;
    # 	* 1. Use the most exposed - e.g. if exposed (smk_exp=1) and unexposed (smk_exp=0), use exposed
    # 	* 2. Use the measure closest to the child's first (not latter) birthday - e.g. for smk_exp0 use the measure clostest to child's birth and for smk_exp_1 use the measure closest to child's first birthday
    
    #------------------------------------------------------------------------------------------------#
    # 114. PET's AT CHILD's HOME ('pets_0-17')
    # * NB! Furry pet (dogs, cats, rodents) ownership in child's household.
    
    # * Check for correct type [binary], number [two] and definition of categories [Any furry pets ownership in child's household; 0= No, 1= Yes]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    pets_ <-
      c(which(names(lc_data) %in% "pets_0"):which(names(lc_data) %in% "pets_17"))
    
    lc_data[, pets_] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, pets_] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
    }
    
    # * If reasonable, please check the distribution against any previously reported distribution of [any exposure to furry pets in household from birth up to 18th birthday] in your cohort
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # * NB! If more than one measure declared within the period, use the following priorization;
    # 	* 1. Use the most exposed - e.g. if exposed (pets_0=1) and unexposed (pets_0=0), use exposed
    # 	* 2. Use the measure closest to the child's first (not latter) birthday, e.g. for pets_0 use the measure clostest to child's birth and for pets_1 use the measure closest to child's first birthday
    
    #------------------------------------------------------------------------------------------------#
    # 115. CHILD's EXPOSURE TO PARENTAL MENTAL DISORDERS ('mental_exp0-17')
    # * If there are no details of "any" psychiatric disorder but details of e.g. depression and anxiety, these can be included as "any" psychiatric disorder; this will then be partial harmonisation!
    # * Visits to a psychologists or psychiatrist should only be used as an indication of a psychiatric disorder if no other data are available. This being the case, the variable will be partially harmonised (which should be detailed in full in the online catalogue).
    
    # * Check for correct type [binary], number [two] and definition of categories [Any exposure to parental mental disorders; 0= No, 1= Yes]
    # * Also, check for correct number of time bands [eightteen, 0-17]
    mental_exp <-
      c(which(names(lc_data) %in% "mental_exp0"):which(names(lc_data) %in% "mental_exp17"))
    
    lc_data[, mental_exp] %>%
      names() %>%
      numextract() %>%
      range()
    
    # Second: print the summary stats for all variables
    var_names <- lc_data[, mental_exp] %>%
      names()
    
    for (i in var_names) {
      print(i)
      print(list(summary_stats = summarizeR(lc_data, i)))
    }
    
    #* If reasonable, please check the distribution against any previously reported distribution of [any exposure to parental mental disorders from birth up to 18th birthday] in your cohort
    
    #* Check internal validity, e.g.:
    CrossTable(lc_data$mental_exp0, lc_data$ppd) # NB! A mother with post-partum depression (ppd=1) must be coded as having mental_exp (mental_exp0=1)
    
    # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
    # ** NB! If more than one measure declared within the period, use the following priorization;
    #  * 1. Use the most exposed - e.g. if exposed (mental_exp=1) and unexposed (mental_exp=0), use exposed
    #  * 2. Use the measure closest to the child's first (not latter) birthday, e.g. for mental_exp0 use the measure clostest to child's birth and for mental_exp1 use the measure closest to child's first birthday
  })

#' Household characteristics
#' Involves variables 116-115
#'
#' @param lc_data core variables from LifeCycle
#'
#' @importFrom gmodels CrossTable
#' @importFrom plotly ggplotly
#'
lc.quality.local.core.household.char <- local(function(lc_data) {
  message("- Household - characteristics")
  # 116. HOUSEHOLD INCOME [CORE] ('hhincome_0-17')
  # * NB! Income categorised into quartiles (low, medium-low, medium-high, high) based on the national household income distribution in the year of follow-up.
  
  # * Check for correct type [categorical], number [four] and definition of categories [income in quantiles; 1=4th (highest), 2=3rd, 3=2nd, 1st (lowest)]
  # * Also, Check for correct number of time bands [eightteen, 0-17]
  hhincome_ <-
    c(which(names(lc_data) %in% "hhincome_0"):which(names(lc_data) %in% "hhincome_17"))
  
  lc_data[, hhincome_] %>%
    names() %>%
    numextract() %>%
    range()
  
  # Second: print the summary stats for all variables
  var_names <- lc_data[, hhincome_] %>%
    names()
  
  for (i in var_names) {
    print(i)
    print(list(summary_stats = summarizeR(lc_data, i)))
  }
  # * Check internal validity, e.g.:
  CrossTable(lc_data$hhincome_0, lc_data$cohab_0)
  CrossTable(lc_data$hhincome_0, lc_data$occup_m_0)
  
  # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
  
  #------------------------------------------------------------------------------------------------#
  # 117. FAMILY SPLIT UP ('fam_splitup0-17')
  # * NB! Any recorded split up. 'fam_splitup0' indicates that the index child was exposed to a split up when the child was ≥0 to <1 year
  # * NB! If the mother was originally single (no partner) and remains single, fam_splitupX = 0 (no split up)
  
  # * Check for correct type [binary], number [two] and definition of categories [0=No split up, 1=Yes, split up]
  # * Also, check for correct number of time bands [eightteen, 0-17]
  fam_splitup <-
    c(which(names(lc_data) %in% "fam_splitup0"):which(names(lc_data) %in% "fam_splitup17"))
  
  lc_data[, fam_splitup] %>%
    names() %>%
    numextract() %>%
    range()
  
  # Second: print the summary stats for all variables
  var_names <- lc_data[, fam_splitup] %>%
    names()
  
  for (i in var_names) {
    print(i)
    print(list(summary_stats = summarizeR(lc_data, i)))
  }
  
  # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
  # ** NB! If more than one measure declared within the period, use the measure closest to the child's first birthday, e.g. for fam_splitup0 use the measure closest to child's birth and for fam_splitup1 use the measure closest to child's first birthday)
  
  # ------------------------------------------------------------------------------------------------#
  # 118. FAMILY SIZE
  # a. ('famsize_child0-17')
  # * If the cohort has a different definition for child (e.g. <14 years) harmonisation is still possible, but the variable will be a partial match (this should be detailed under the match in the catalogue)
  # * NB! This is the household where the child lives the majority of the time
  
  # * Check for outliers and impossible values (e.g. substantial high values, of children)
  # * Also, check for correct number of time bands [eightteen, 0-17]
  famsize_child <-
    c(which(names(lc_data) %in% "famsize_child0"):which(names(lc_data) %in% "famsize_child17"))
  
  lc_data[, famsize_child] %>%
    names() %>%
    numextract() %>%
    range()
  
  # Second: print the summary stats for all variables
  var_names <- lc_data[, famsize_child] %>%
    names()
  
  for (i in var_names) {
    print(i)
    print(list(summary_stats = summarizeR(lc_data, i)))
  }
  
  # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
  # ** NB! If more than one measure declared within the period, use the measure closest to the child's first birthday, e.g. for famsize_child0 use the measure closest to child's birth and for famsize_child1 use the measure closest to child's first birthday)
  
  #--------------------------------#
  # b. ('famsize_adult0-17')
  # * Check for outliers and impossible values (e.g. substantial high values, of children)
  # * Also, check for correct number of time bands [eightteen, 0-17]
  famsize_adult <-
    c(which(names(lc_data) %in% "famsize_adult0"):which(names(lc_data) %in% "famsize_adult17"))
  
  lc_data[, famsize_adult] %>%
    names() %>%
    numextract() %>%
    range()
  
  # Second: print the summary stats for all variables
  var_names <- lc_data[, famsize_adult] %>%
    names()
  
  for (i in var_names) {
    print(i)
    print(list(summary_stats = summarizeR(lc_data, i)))
  }
  
  # * Replicate example from '8. Cohab_0-17' to check that date of collection corresponds to the exact age-band (do this for all age-bands where you have data)
  # ** NB! If more than one measure declared within the period, use the measure closest to the child's first birthday, e.g. for famsize_adult0 use the measure closest to child's birth and for famsize_adult1 use the measure closest to child's first birthday)
})
